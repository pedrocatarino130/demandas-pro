{"version":3,"file":"firebase-service-DlA8zRSG.js","sources":["../../src/config/firebase.js","../../src/services/firebase-sync.js","../../src/services/firebase-service.js"],"sourcesContent":["/**\n * Configura√ß√£o do Firebase\n * Inicializa e exporta os servi√ßos do Firebase\n */\n\nimport {\n    initializeApp\n} from 'firebase/app';\nimport {\n    getFirestore,\n    enableIndexedDbPersistence,\n    connectFirestoreEmulator\n} from 'firebase/firestore';\nimport {\n    getAuth\n} from 'firebase/auth';\n\n// Configura√ß√£o do Firebase usando vari√°veis de ambiente\nconst firebaseConfig = {\n    apiKey: import.meta.env.VITE_FIREBASE_API_KEY,\n    authDomain: import.meta.env.VITE_FIREBASE_AUTH_DOMAIN,\n    projectId: import.meta.env.VITE_FIREBASE_PROJECT_ID,\n    storageBucket: import.meta.env.VITE_FIREBASE_STORAGE_BUCKET,\n    messagingSenderId: import.meta.env.VITE_FIREBASE_MESSAGING_SENDER_ID,\n    appId: import.meta.env.VITE_FIREBASE_APP_ID,\n};\n\n// Validar configura√ß√£o\nif (!firebaseConfig.apiKey || !firebaseConfig.projectId) {\n    console.warn('‚ö†Ô∏è Firebase n√£o configurado. Usando modo offline apenas.');\n}\n\n// Inicializar Firebase\nlet app;\nlet db;\nlet auth;\n\ntry {\n    app = initializeApp(firebaseConfig);\n    db = getFirestore(app);\n    auth = getAuth(app);\n\n    // Habilitar persist√™ncia offline do Firestore (cache local)\n    enableIndexedDbPersistence(db).catch((err) => {\n        if (err.code === 'failed-precondition') {\n            // M√∫ltiplas abas abertas, persist√™ncia s√≥ pode ser habilitada em uma\n            console.warn('‚ö†Ô∏è Persist√™ncia offline do Firestore n√£o habilitada: m√∫ltiplas abas abertas');\n        } else if (err.code === 'unimplemented') {\n            // Navegador n√£o suporta persist√™ncia\n            console.warn('‚ö†Ô∏è Persist√™ncia offline do Firestore n√£o suportada neste navegador');\n        } else {\n            console.error('‚ùå Erro ao habilitar persist√™ncia offline:', err);\n        }\n    });\n\n    console.log('‚úÖ Firebase inicializado com sucesso');\n} catch (error) {\n    console.error('‚ùå Erro ao inicializar Firebase:', error);\n    // Em caso de erro, criar objetos vazios para evitar quebra da aplica√ß√£o\n    db = null;\n    auth = null;\n}\n\nexport {\n    app,\n    db,\n    auth\n};\nexport default {\n    app,\n    db,\n    auth\n};","/**\n * Gerenciamento de Sincroniza√ß√£o Online/Offline\n * Fila de opera√ß√µes pendentes e sincroniza√ß√£o autom√°tica\n */\n\nimport { firebaseCache } from './firebase-cache.js';\n\nconst SYNC_QUEUE_KEY = 'firebase-sync-queue';\nconst MAX_RETRIES = 3;\n\n/**\n * Classe para gerenciar sincroniza√ß√£o\n */\nclass FirebaseSync {\n    constructor() {\n        this.queue = [];\n        this.isOnline = navigator.onLine;\n        this.syncInProgress = false;\n        this.listeners = [];\n\n        // Escutar eventos de conex√£o\n        window.addEventListener('online', () => this.handleOnline());\n        window.addEventListener('offline', () => this.handleOffline());\n\n        // Carregar fila existente\n        this.loadQueue();\n    }\n\n    /**\n     * Carrega a fila de sincroniza√ß√£o do cache\n     */\n    async loadQueue() {\n        const savedQueue = await firebaseCache.get(SYNC_QUEUE_KEY);\n        if (savedQueue && Array.isArray(savedQueue)) {\n            this.queue = savedQueue;\n        }\n    }\n\n    /**\n     * Salva a fila de sincroniza√ß√£o no cache\n     */\n    async saveQueue() {\n        await firebaseCache.set(SYNC_QUEUE_KEY, this.queue);\n    }\n\n    /**\n     * Adiciona opera√ß√£o √† fila\n     * @param {Object} operation - Opera√ß√£o pendente\n     */\n    async addToQueue(operation) {\n        this.queue.push({\n            ...operation,\n            timestamp: Date.now(),\n            retries: 0,\n        });\n        await this.saveQueue();\n        this.notifyListeners();\n\n        // Tentar sincronizar se estiver online\n        if (this.isOnline) {\n            this.sync();\n        }\n    }\n\n    /**\n     * Processa a fila de sincroniza√ß√£o\n     */\n    async sync() {\n        if (this.syncInProgress || !this.isOnline || this.queue.length === 0) {\n            return;\n        }\n\n        this.syncInProgress = true;\n        this.notifyListeners();\n\n        const operations = [...this.queue];\n        const successful = [];\n        const failed = [];\n\n        for (const operation of operations) {\n            try {\n                // Executar opera√ß√£o\n                await operation.execute();\n                successful.push(operation);\n            } catch (error) {\n                console.error('Erro ao sincronizar opera√ß√£o:', error);\n                operation.retries++;\n\n                if (operation.retries < MAX_RETRIES) {\n                    failed.push(operation);\n                } else {\n                    console.warn('Opera√ß√£o falhou ap√≥s m√°ximo de tentativas:', operation);\n                }\n            }\n        }\n\n        // Atualizar fila removendo opera√ß√µes bem-sucedidas\n        this.queue = failed;\n        await this.saveQueue();\n\n        this.syncInProgress = false;\n        this.notifyListeners();\n\n        if (successful.length > 0) {\n            console.log(`‚úÖ ${successful.length} opera√ß√£o(√µes) sincronizada(s)`);\n        }\n\n        if (failed.length > 0) {\n            console.warn(`‚ö†Ô∏è ${failed.length} opera√ß√£o(√µes) falharam e ser√£o tentadas novamente`);\n        }\n    }\n\n    /**\n     * Manipula quando a conex√£o volta\n     */\n    async handleOnline() {\n        console.log('üåê Conex√£o restabelecida');\n        this.isOnline = true;\n        this.notifyListeners();\n\n        // Sincronizar pend√™ncias\n        if (this.queue.length > 0) {\n            await this.sync();\n        }\n    }\n\n    /**\n     * Manipula quando a conex√£o cai\n     */\n    handleOffline() {\n        console.log('üì¥ Conex√£o perdida');\n        this.isOnline = false;\n        this.notifyListeners();\n    }\n\n    /**\n     * Verifica status online\n     */\n    getOnlineStatus() {\n        return this.isOnline;\n    }\n\n    /**\n     * Verifica se h√° opera√ß√µes pendentes\n     */\n    hasPendingOperations() {\n        return this.queue.length > 0;\n    }\n\n    /**\n     * Obt√©m n√∫mero de opera√ß√µes pendentes\n     */\n    getPendingCount() {\n        return this.queue.length;\n    }\n\n    /**\n     * Inscreve listener para mudan√ßas de status\n     */\n    subscribe(callback) {\n        this.listeners.push(callback);\n        return () => {\n            this.listeners = this.listeners.filter(l => l !== callback);\n        };\n    }\n\n    /**\n     * Notifica todos os listeners\n     */\n    notifyListeners() {\n        this.listeners.forEach(callback => {\n            try {\n                callback({\n                    isOnline: this.isOnline,\n                    hasPending: this.hasPendingOperations(),\n                    pendingCount: this.getPendingCount(),\n                    syncing: this.syncInProgress,\n                });\n            } catch (error) {\n                console.error('Erro ao notificar listener:', error);\n            }\n        });\n    }\n\n    /**\n     * Limpa a fila de sincroniza√ß√£o\n     */\n    async clearQueue() {\n        this.queue = [];\n        await this.saveQueue();\n        this.notifyListeners();\n    }\n}\n\n// Exportar inst√¢ncia singleton\nexport const firebaseSync = new FirebaseSync();\nexport default firebaseSync;\n\n","/**\n * Servi√ßo Principal do Firebase\n * Abstrai opera√ß√µes CRUD do Firestore com cache local e sincroniza√ß√£o\n */\n\nimport { db } from '../config/firebase.js';\nimport {\n    collection,\n    doc,\n    getDoc,\n    getDocs,\n    setDoc,\n    updateDoc,\n    deleteDoc,\n    addDoc,\n    query,\n    where,\n    orderBy,\n    onSnapshot,\n    writeBatch,\n    serverTimestamp,\n} from 'firebase/firestore';\nimport { firebaseCache } from './firebase-cache.js';\nimport { firebaseSync } from './firebase-sync.js';\n\n/**\n * Classe principal do servi√ßo Firebase\n */\nclass FirebaseService {\n    constructor() {\n        this.db = db;\n        this.listeners = new Map(); // Armazenar listeners ativos\n        this.cachePrefix = 'firestore-';\n    }\n\n    /**\n     * Verifica se o Firestore est√° dispon√≠vel\n     */\n    isAvailable() {\n        return this.db !== null;\n    }\n\n    /**\n     * Obt√©m uma refer√™ncia para uma cole√ß√£o\n     */\n    getCollectionRef(collectionName) {\n        if (!this.isAvailable()) {\n            throw new Error('Firestore n√£o est√° dispon√≠vel');\n        }\n        return collection(this.db, collectionName);\n    }\n\n    /**\n     * Obt√©m uma refer√™ncia para um documento\n     */\n    getDocumentRef(collectionName, docId) {\n        if (!this.isAvailable()) {\n            throw new Error('Firestore n√£o est√° dispon√≠vel');\n        }\n        return doc(this.db, collectionName, docId);\n    }\n\n    /**\n     * Obt√©m chave de cache para um documento\n     */\n    getCacheKey(collectionName, docId) {\n        return `${this.cachePrefix}${collectionName}/${docId}`;\n    }\n\n    /**\n     * L√™ um documento do Firestore com cache\n     * @param {string} collectionName - Nome da cole√ß√£o\n     * @param {string} docId - ID do documento\n     * @returns {Promise<any|null>} Dados do documento ou null\n     */\n    async getDocument(collectionName, docId) {\n        const cacheKey = this.getCacheKey(collectionName, docId);\n\n        try {\n            // Tentar ler do Firestore\n            if (this.isAvailable() && firebaseSync.getOnlineStatus()) {\n                const docRef = this.getDocumentRef(collectionName, docId);\n                const docSnap = await getDoc(docRef);\n\n                if (docSnap.exists()) {\n                    const data = {\n                        id: docSnap.id,\n                        ...docSnap.data(),\n                    };\n                    // Atualizar cache\n                    await firebaseCache.set(cacheKey, data);\n                    return data;\n                }\n            }\n        } catch (error) {\n            console.warn(`Erro ao ler documento do Firestore (${collectionName}/${docId}):`, error);\n        }\n\n        // Fallback para cache\n        return await firebaseCache.get(cacheKey);\n    }\n\n    /**\n     * L√™ todos os documentos de uma cole√ß√£o\n     * @param {string} collectionName - Nome da cole√ß√£o\n     * @param {Array} filters - Filtros opcionais [{field, operator, value}]\n     * @param {string} orderByField - Campo para ordena√ß√£o\n     * @param {string} orderDirection - Dire√ß√£o da ordena√ß√£o ('asc' ou 'desc')\n     * @returns {Promise<Array>} Array de documentos\n     */\n    async getCollection(collectionName, filters = [], orderByField = null, orderDirection = 'asc') {\n        try {\n            if (this.isAvailable() && firebaseSync.getOnlineStatus()) {\n                let q = this.getCollectionRef(collectionName);\n\n                // Aplicar filtros\n                filters.forEach(filter => {\n                    q = query(q, where(filter.field, filter.operator, filter.value));\n                });\n\n                // Aplicar ordena√ß√£o\n                if (orderByField) {\n                    q = query(q, orderBy(orderByField, orderDirection));\n                }\n\n                const querySnapshot = await getDocs(q);\n                const documents = [];\n\n                querySnapshot.forEach((docSnap) => {\n                    documents.push({\n                        id: docSnap.id,\n                        ...docSnap.data(),\n                    });\n                });\n\n                // Atualizar cache da cole√ß√£o inteira\n                const cacheKey = `${this.cachePrefix}collection-${collectionName}`;\n                await firebaseCache.set(cacheKey, documents);\n\n                return documents;\n            }\n        } catch (error) {\n            console.warn(`Erro ao ler cole√ß√£o do Firestore (${collectionName}):`, error);\n        }\n\n        // Fallback para cache\n        const cacheKey = `${this.cachePrefix}collection-${collectionName}`;\n        const cached = await firebaseCache.get(cacheKey);\n        return cached || [];\n    }\n\n    /**\n     * Cria ou atualiza um documento\n     * @param {string} collectionName - Nome da cole√ß√£o\n     * @param {string} docId - ID do documento (opcional, ser√° gerado se n√£o fornecido)\n     * @param {Object} data - Dados do documento\n     * @param {boolean} merge - Se true, faz merge com dados existentes\n     * @returns {Promise<string>} ID do documento\n     */\n    async setDocument(collectionName, docId, data, merge = true) {\n        const cacheKey = this.getCacheKey(collectionName, docId);\n\n        // Atualizar cache imediatamente\n        const documentData = {\n            ...data,\n            updatedAt: new Date().toISOString(),\n        };\n        await firebaseCache.set(cacheKey, documentData);\n\n        // Se estiver offline, adicionar √† fila de sincroniza√ß√£o\n        if (!firebaseSync.getOnlineStatus()) {\n            await firebaseSync.addToQueue({\n                type: 'set',\n                collection: collectionName,\n                docId,\n                data: documentData,\n                merge,\n                execute: async () => {\n                    return this._executeSetDocument(collectionName, docId, documentData, merge);\n                },\n            });\n            return docId;\n        }\n\n        // Se estiver online, salvar imediatamente\n        try {\n            return await this._executeSetDocument(collectionName, docId, documentData, merge);\n        } catch (error) {\n            console.error(`Erro ao salvar documento no Firestore (${collectionName}/${docId}):`, error);\n            // Adicionar √† fila mesmo se falhar\n            await firebaseSync.addToQueue({\n                type: 'set',\n                collection: collectionName,\n                docId,\n                data: documentData,\n                merge,\n                execute: async () => {\n                    return this._executeSetDocument(collectionName, docId, documentData, merge);\n                },\n            });\n            throw error;\n        }\n    }\n\n    /**\n     * Executa a opera√ß√£o de set no Firestore\n     */\n    async _executeSetDocument(collectionName, docId, data, merge) {\n        if (!this.isAvailable()) {\n            throw new Error('Firestore n√£o est√° dispon√≠vel');\n        }\n\n        // Remover campo id se existir (√© metadado do Firestore)\n        const { id, ...firestoreData } = data;\n\n        if (docId) {\n            const docRef = this.getDocumentRef(collectionName, docId);\n            await setDoc(docRef, {\n                ...firestoreData,\n                updatedAt: serverTimestamp(),\n            }, { merge });\n            return docId;\n        } else {\n            const collectionRef = this.getCollectionRef(collectionName);\n            const docRef = await addDoc(collectionRef, {\n                ...firestoreData,\n                createdAt: serverTimestamp(),\n                updatedAt: serverTimestamp(),\n            });\n            return docRef.id;\n        }\n    }\n\n    /**\n     * Atualiza um documento existente\n     */\n    async updateDocument(collectionName, docId, updates) {\n        return this.setDocument(collectionName, docId, updates, true);\n    }\n\n    /**\n     * Deleta um documento\n     */\n    async deleteDocument(collectionName, docId) {\n        const cacheKey = this.getCacheKey(collectionName, docId);\n\n        // Remover do cache imediatamente\n        await firebaseCache.remove(cacheKey);\n\n        // Se estiver offline, adicionar √† fila\n        if (!firebaseSync.getOnlineStatus()) {\n            await firebaseSync.addToQueue({\n                type: 'delete',\n                collection: collectionName,\n                docId,\n                execute: async () => {\n                    return this._executeDeleteDocument(collectionName, docId);\n                },\n            });\n            return;\n        }\n\n        // Se estiver online, deletar imediatamente\n        try {\n            await this._executeDeleteDocument(collectionName, docId);\n        } catch (error) {\n            console.error(`Erro ao deletar documento do Firestore (${collectionName}/${docId}):`, error);\n            await firebaseSync.addToQueue({\n                type: 'delete',\n                collection: collectionName,\n                docId,\n                execute: async () => {\n                    return this._executeDeleteDocument(collectionName, docId);\n                },\n            });\n            throw error;\n        }\n    }\n\n    /**\n     * Executa a opera√ß√£o de delete no Firestore\n     */\n    async _executeDeleteDocument(collectionName, docId) {\n        if (!this.isAvailable()) {\n            throw new Error('Firestore n√£o est√° dispon√≠vel');\n        }\n\n        const docRef = this.getDocumentRef(collectionName, docId);\n        await deleteDoc(docRef);\n    }\n\n    /**\n     * Salva m√∫ltiplos documentos em uma √∫nica transa√ß√£o\n     */\n    async batchWrite(operations) {\n        if (!this.isAvailable()) {\n            throw new Error('Firestore n√£o est√° dispon√≠vel');\n        }\n\n        const batch = writeBatch(this.db);\n\n        for (const op of operations) {\n            const docRef = this.getDocumentRef(op.collection, op.docId);\n\n            switch (op.type) {\n                case 'set':\n                    batch.set(docRef, {\n                        ...op.data,\n                        updatedAt: serverTimestamp(),\n                    }, { merge: op.merge || false });\n                    break;\n                case 'update':\n                    batch.update(docRef, {\n                        ...op.data,\n                        updatedAt: serverTimestamp(),\n                    });\n                    break;\n                case 'delete':\n                    batch.delete(docRef);\n                    break;\n            }\n        }\n\n        await batch.commit();\n    }\n\n    /**\n     * Escuta mudan√ßas em tempo real em um documento\n     */\n    subscribeToDocument(collectionName, docId, callback) {\n        if (!this.isAvailable()) {\n            // Usar cache como fallback\n            const cacheKey = this.getCacheKey(collectionName, docId);\n            firebaseCache.get(cacheKey).then(callback);\n            return () => {};\n        }\n\n        const docRef = this.getDocumentRef(collectionName, docId);\n        const listenerKey = `${collectionName}/${docId}`;\n\n        const unsubscribe = onSnapshot(\n            docRef,\n            (docSnap) => {\n                const data = docSnap.exists() ? {\n                    id: docSnap.id,\n                    ...docSnap.data(),\n                } : null;\n\n                // Atualizar cache\n                if (data) {\n                    const cacheKey = this.getCacheKey(collectionName, docId);\n                    firebaseCache.set(cacheKey, data);\n                }\n\n                callback(data);\n            },\n            (error) => {\n                console.error(`Erro ao escutar documento (${collectionName}/${docId}):`, error);\n            }\n        );\n\n        this.listeners.set(listenerKey, unsubscribe);\n\n        return () => {\n            unsubscribe();\n            this.listeners.delete(listenerKey);\n        };\n    }\n\n    /**\n     * Escuta mudan√ßas em tempo real em uma cole√ß√£o\n     */\n    subscribeToCollection(collectionName, callback, filters = []) {\n        if (!this.isAvailable()) {\n            // Usar cache como fallback\n            const cacheKey = `${this.cachePrefix}collection-${collectionName}`;\n            firebaseCache.get(cacheKey).then(data => callback(data || []));\n            return () => {};\n        }\n\n        let q = this.getCollectionRef(collectionName);\n\n        filters.forEach(filter => {\n            q = query(q, where(filter.field, filter.operator, filter.value));\n        });\n\n        const listenerKey = `collection-${collectionName}`;\n\n        const unsubscribe = onSnapshot(\n            q,\n            (querySnapshot) => {\n                const documents = [];\n                querySnapshot.forEach((docSnap) => {\n                    documents.push({\n                        id: docSnap.id,\n                        ...docSnap.data(),\n                    });\n                });\n\n                // Atualizar cache\n                const cacheKey = `${this.cachePrefix}collection-${collectionName}`;\n                firebaseCache.set(cacheKey, documents);\n\n                callback(documents);\n            },\n            (error) => {\n                console.error(`Erro ao escutar cole√ß√£o (${collectionName}):`, error);\n            }\n        );\n\n        this.listeners.set(listenerKey, unsubscribe);\n\n        return () => {\n            unsubscribe();\n            this.listeners.delete(listenerKey);\n        };\n    }\n\n    /**\n     * Remove todos os listeners\n     */\n    unsubscribeAll() {\n        this.listeners.forEach(unsubscribe => unsubscribe());\n        this.listeners.clear();\n    }\n}\n\n// Exportar inst√¢ncia singleton\nexport const firebaseService = new FirebaseService();\nexport default firebaseService;\n\n"],"names":["firebaseConfig","app","db","auth","initializeApp","getFirestore","getAuth","enableIndexedDbPersistence","err","error","SYNC_QUEUE_KEY","MAX_RETRIES","FirebaseSync","savedQueue","firebaseCache","operation","operations","successful","failed","callback","l","firebaseSync","FirebaseService","collectionName","collection","docId","doc","cacheKey","docRef","docSnap","getDoc","data","filters","orderByField","orderDirection","q","filter","query","where","orderBy","querySnapshot","getDocs","documents","merge","documentData","id","firestoreData","setDoc","serverTimestamp","collectionRef","addDoc","updates","deleteDoc","batch","writeBatch","op","listenerKey","unsubscribe","onSnapshot","firebaseService"],"mappings":"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"}