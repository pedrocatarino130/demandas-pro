import{f as c}from"./firebase-service-DlA8zRSG.js";import{f as l}from"./firebase-cache-CNydOCth.js";import"./firebase-DLTXyntu.js";import"./idb-Dob3nYDb.js";const d="default";async function _(){console.log("ðŸ”„ Iniciando migraÃ§Ã£o localStorage â†’ Firestore...");try{if(await l.get("firestore-migration-completed"))return console.log("âœ… MigraÃ§Ã£o jÃ¡ foi concluÃ­da anteriormente"),{success:!0,skipped:!0};await l.init();const t={tarefas:0,rotina:0,categorias:0,estudos:0,notas:0,config:0,errors:[]};return await f(t),await u(t),await p(t),await m(t),await S(t),await h(t),await l.set("firestore-migration-completed",{timestamp:new Date().toISOString(),results:t}),console.log("âœ… MigraÃ§Ã£o concluÃ­da:",t),{success:!0,results:t}}catch(r){return console.error("âŒ Erro na migraÃ§Ã£o:",r),{success:!1,error:r.message}}}async function f(r){try{const t=localStorage.getItem("gerenciador_v3_state");let e=[],a=[];if(t){const s=JSON.parse(t);e=s.tarefas||[],a=s.tarefasHome||[]}else{const s=localStorage.getItem("tarefas_projetos_v2");s&&(e=JSON.parse(s))}const o=[];for(const s of e)s.id&&o.push({type:"set",collection:"tarefas",docId:s.id,data:{...s,tipo:"projeto",updatedAt:new Date().toISOString()},merge:!1});for(const s of a)s.id&&o.push({type:"set",collection:"tarefas",docId:s.id,data:{...s,tipo:"home",updatedAt:new Date().toISOString()},merge:!1});o.length>0&&c.isAvailable()&&(await c.batchWrite(o),r.tarefas=o.length,console.log(`âœ… Migradas ${o.length} tarefas`))}catch(t){r.errors.push({type:"tarefas",error:t.message}),console.error("Erro ao migrar tarefas:",t)}}async function u(r){try{let t=[],e=[];const a=localStorage.getItem("gerenciador_v3_state");if(a){const o=JSON.parse(a);t=o.tarefasRotina||[],e=o.historico||[]}else{const o=localStorage.getItem("tarefas_rotina_v5");o&&(t=JSON.parse(o));const s=localStorage.getItem("historico_rotina_v5");s&&(e=JSON.parse(s))}(t.length>0||e.length>0)&&c.isAvailable()&&(await c.setDocument("rotina",d,{tarefasRotina:t,historico:e,contadorRotina:t.length,updatedAt:new Date().toISOString()},!1),r.rotina=t.length+e.length,console.log(`âœ… Migrados dados de rotina (${t.length} tarefas, ${e.length} histÃ³rico)`))}catch(t){r.errors.push({type:"rotina",error:t.message}),console.error("Erro ao migrar rotina:",t)}}async function p(r){try{let t=[];const e=localStorage.getItem("gerenciador_v3_state");if(e)t=JSON.parse(e).categorias||[];else{const a=localStorage.getItem("categorias_rotina_v4");a&&(t=JSON.parse(a))}if(t.length>0&&c.isAvailable()){const a=[];for(const o of t)o.id&&a.push({type:"set",collection:"categorias",docId:o.id,data:{...o,updatedAt:new Date().toISOString()},merge:!1});a.length>0&&(await c.batchWrite(a),r.categorias=a.length,console.log(`âœ… Migradas ${a.length} categorias`))}}catch(t){r.errors.push({type:"categorias",error:t.message}),console.error("Erro ao migrar categorias:",t)}}async function m(r){try{let t=[],e=[],a=[],o={};const s=localStorage.getItem("gerenciador_v3_state");if(s){const i=JSON.parse(s);t=i.areasEstudo||[],e=i.topicosEstudo||[],a=i.tagsEstudo||[],o=i.configEstudos||{}}else{const i=localStorage.getItem("estudos_dados_v2");if(i){const g=JSON.parse(i);t=g.areas||[],e=g.topicos||[],a=g.tags||[],o=g.config||{}}}const n=localStorage.getItem("estudos_v3");if(n&&t.length===0&&e.length===0){const i=JSON.parse(n);t=i.areas||[],e=i.topicos||[]}(t.length>0||e.length>0)&&c.isAvailable()&&(await c.setDocument("estudos",d,{areasEstudo:t,topicosEstudo:e,tagsEstudo:a,configEstudos:o,contadorEstudos:e.length,updatedAt:new Date().toISOString()},!1),r.estudos=t.length+e.length,console.log(`âœ… Migrados dados de estudos (${t.length} Ã¡reas, ${e.length} tÃ³picos)`))}catch(t){r.errors.push({type:"estudos",error:t.message}),console.error("Erro ao migrar estudos:",t)}}async function S(r){try{const t=[];for(let e=0;e<localStorage.length;e++){const a=localStorage.key(e);if(a&&a.startsWith("notas_"))try{const o=JSON.parse(localStorage.getItem(a));t.push({key:a.replace("notas_",""),data:o})}catch(o){console.warn(`Erro ao migrar nota ${a}:`,o)}}if(t.length>0&&c.isAvailable()){const e=[];for(const a of t)e.push({type:"set",collection:"notas",docId:`notas_${a.key}`,data:{topicoId:a.data.topicoId||a.key,content:a.data.content||"",timestamp:a.data.timestamp||new Date().toISOString(),updatedAt:new Date().toISOString()},merge:!1});e.length>0&&(await c.batchWrite(e),r.notas=e.length,console.log(`âœ… Migradas ${e.length} notas`))}}catch(t){r.errors.push({type:"notas",error:t.message}),console.error("Erro ao migrar notas:",t)}}async function h(r){try{let t=0,e={},a=[],o=!1,s=null;const n=localStorage.getItem("gerenciador_v3_state");if(n){const i=JSON.parse(n);t=i.streak||0,e=i.conquistas||{},a=i.avaliacoesDiarias||[],o=i.darkMode||!1,s=i.filtroStatus||null}else{const i=localStorage.getItem("avaliacoes_diarias_v1");i&&(a=JSON.parse(i))}c.isAvailable()&&(await c.setDocument("config",d,{streak:t,conquistas:e,avaliacoesDiarias:a,darkMode:o,filtroStatus:s,ultimaAtualizacao:new Date().toISOString(),updatedAt:new Date().toISOString()},!1),r.config=1,console.log("âœ… Migradas configuraÃ§Ãµes"))}catch(t){r.errors.push({type:"config",error:t.message}),console.error("Erro ao migrar configuraÃ§Ãµes:",t)}}async function O(){const r={};try{for(let t=0;t<localStorage.length;t++){const e=localStorage.key(t);if(e)try{r[e]=localStorage.getItem(e)}catch(a){console.warn(`Erro ao fazer backup de ${e}:`,a)}}return await l.init(),await l.set("localStorage-backup",{timestamp:new Date().toISOString(),data:r}),console.log("âœ… Backup criado com sucesso"),{success:!0,itemCount:Object.keys(r).length}}catch(t){return console.error("âŒ Erro ao criar backup:",t),{success:!1,error:t.message}}}export{O as createBackup,_ as default,_ as migrateLocalStorageToFirebase};
//# sourceMappingURL=migrate-localStorage-to-firebase-DBoqDX6d.js.map
