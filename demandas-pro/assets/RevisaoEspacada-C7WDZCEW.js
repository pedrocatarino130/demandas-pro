class v{constructor(e={}){this.intervalos=e.intervalos||[1,3,7,15,30],this.dificuldadeInicial=e.dificuldadeInicial||2.5}calcularProximaRevisao(e,a=new Date){if(!e)throw new Error("Tópico é obrigatório");if(!e.concluidoEm)return{proximaRevisao:null,intervalo:null,tentativa:0};const t=this._contarRevisoes(e),s=this._getIntervalo(t),r=e.ultimaRevisao?new Date(e.ultimaRevisao):new Date(e.concluidoEm),i=new Date(r);return i.setDate(i.getDate()+s),{proximaRevisao:i.toISOString(),intervalo:s,tentativa:t+1,diasRestantes:Math.ceil((i-a)/(1e3*60*60*24))}}_getIntervalo(e){return e<this.intervalos.length?this.intervalos[e]:this.intervalos[this.intervalos.length-1]}_contarRevisoes(e){if(e.historicoRevisoes&&Array.isArray(e.historicoRevisoes))return e.historicoRevisoes.length;if(e.status==="Concluído"&&e.concluidoEm){if(e.proximaRevisao){const a=new Date(e.proximaRevisao),t=new Date(e.concluidoEm),s=Math.floor((a-t)/(1e3*60*60*24)),r=this.intervalos.findIndex(i=>i===s);return r>=0?r:0}return 0}return 0}registrarRevisao(e,a=3,t=new Date){if(!e)throw new Error("Tópico é obrigatório");e.historicoRevisoes||(e.historicoRevisoes=[]);const s={data:t.toISOString(),dificuldade:a,intervalo:this._getIntervalo(e.historicoRevisoes.length)};e.historicoRevisoes.push(s),e.ultimaRevisao=t.toISOString();const r=this.calcularProximaRevisao(e,t);if(a>=4){const i=r.intervalo,n=Math.max(1,Math.floor(i*.7)),o=new Date(t);o.setDate(o.getDate()+n),e.proximaRevisao=o.toISOString()}else e.proximaRevisao=r.proximaRevisao;if(a<=2&&e.historicoRevisoes.length>1){const i=r.intervalo,n=Math.min(30,Math.floor(i*1.3)),o=new Date(t);o.setDate(o.getDate()+n),e.proximaRevisao=o.toISOString()}return e}isRevisaoPendente(e,a=new Date){return!e||!e.proximaRevisao?!1:new Date(e.proximaRevisao)<=a}getRevisoesPendentes(e){return Array.isArray(e)?e.filter(a=>this.isRevisaoPendente(a)).sort((a,t)=>{const s=new Date(a.proximaRevisao),r=new Date(t.proximaRevisao);return s-r}):[]}getEstatisticas(e){if(!Array.isArray(e))return{total:0,pendentes:0,hoje:0,estaSemana:0,proximaSemana:0};const a=new Date;a.setHours(0,0,0,0);const t=new Date(a);t.setDate(t.getDate()+7);const s=new Date(a);s.setDate(s.getDate()+14);const r={total:e.filter(i=>i.proximaRevisao).length,pendentes:0,hoje:0,estaSemana:0,proximaSemana:0};return e.forEach(i=>{if(!i.proximaRevisao)return;const n=new Date(i.proximaRevisao);n<=a&&r.pendentes++,n.toDateString()===a.toDateString()&&r.hoje++,n>a&&n<=t&&r.estaSemana++,n>t&&n<=s&&r.proximaSemana++}),r}agendarRevisaoInicial(e,a=new Date){if(!e)throw new Error("Tópico é obrigatório");e.concluidoEm=a.toISOString(),e.status="Concluído";const t=this.calcularProximaRevisao(e,a);return e.proximaRevisao=t.proximaRevisao,e}}typeof module<"u"&&module.exports&&(module.exports=v);export{v as RevisaoEspacada,v as default};
//# sourceMappingURL=RevisaoEspacada-C7WDZCEW.js.map
