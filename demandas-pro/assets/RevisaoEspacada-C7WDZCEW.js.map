{"version":3,"file":"RevisaoEspacada-C7WDZCEW.js","sources":["../../src/components/estudos/RevisaoEspacada.js"],"sourcesContent":["/**\n * TASK-015: Sistema de Revisão Espaçada Melhorado\n * \n * Algoritmo SM-2 simplificado para revisão espaçada\n * Intervalos: 1, 3, 7, 15, 30 dias (progressivo)\n */\n\nclass RevisaoEspacada {\n    constructor(options = {}) {\n        this.intervalos = options.intervalos || [1, 3, 7, 15, 30];\n        this.dificuldadeInicial = options.dificuldadeInicial || 2.5;\n    }\n\n    /**\n     * Calcula próxima revisão baseado no histórico\n     * @param {Object} topico - Tópico com histórico de revisões\n     * @param {Date} dataAtual - Data atual (opcional)\n     * @returns {Object} { proximaRevisao: Date, intervalo: number, tentativa: number }\n     */\n    calcularProximaRevisao(topico, dataAtual = new Date()) {\n        if (!topico) {\n            throw new Error('Tópico é obrigatório');\n        }\n\n        // Se nunca foi concluído, não há revisão\n        if (!topico.concluidoEm) {\n            return {\n                proximaRevisao: null,\n                intervalo: null,\n                tentativa: 0\n            };\n        }\n\n        // Contar revisões já feitas\n        const revisoesFeitas = this._contarRevisoes(topico);\n        \n        // Determinar intervalo baseado no número de revisões\n        const intervalo = this._getIntervalo(revisoesFeitas);\n        \n        // Calcular data da próxima revisão\n        const dataBase = topico.ultimaRevisao \n            ? new Date(topico.ultimaRevisao)\n            : new Date(topico.concluidoEm);\n        \n        const proximaRevisao = new Date(dataBase);\n        proximaRevisao.setDate(proximaRevisao.getDate() + intervalo);\n\n        return {\n            proximaRevisao: proximaRevisao.toISOString(),\n            intervalo: intervalo,\n            tentativa: revisoesFeitas + 1,\n            diasRestantes: Math.ceil((proximaRevisao - dataAtual) / (1000 * 60 * 60 * 24))\n        };\n    }\n\n    /**\n     * Obtém intervalo baseado no número de tentativas\n     */\n    _getIntervalo(tentativa) {\n        if (tentativa < this.intervalos.length) {\n            return this.intervalos[tentativa];\n        }\n        // Após todas as tentativas, usar o último intervalo\n        return this.intervalos[this.intervalos.length - 1];\n    }\n\n    /**\n     * Conta revisões feitas\n     */\n    _contarRevisoes(topico) {\n        // Se tem histórico de revisões, usar isso\n        if (topico.historicoRevisoes && Array.isArray(topico.historicoRevisoes)) {\n            return topico.historicoRevisoes.length;\n        }\n\n        // Senão, inferir do status e datas\n        if (topico.status === 'Concluído' && topico.concluidoEm) {\n            // Se tem próxima revisão agendada, já foi revisado pelo menos uma vez\n            if (topico.proximaRevisao) {\n                const revisaoDate = new Date(topico.proximaRevisao);\n                const concluidoDate = new Date(topico.concluidoEm);\n                const diasEntre = Math.floor((revisaoDate - concluidoDate) / (1000 * 60 * 60 * 24));\n                \n                // Determinar tentativa baseado no intervalo\n                const tentativa = this.intervalos.findIndex(i => i === diasEntre);\n                return tentativa >= 0 ? tentativa : 0;\n            }\n            return 0; // Concluído mas nunca revisado\n        }\n\n        return 0;\n    }\n\n    /**\n     * Registra uma revisão realizada\n     * @param {Object} topico - Tópico revisado\n     * @param {number} dificuldade - Dificuldade percebida (1-5)\n     * @param {Date} dataRevisao - Data da revisão (opcional)\n     * @returns {Object} Tópico atualizado\n     */\n    registrarRevisao(topico, dificuldade = 3, dataRevisao = new Date()) {\n        if (!topico) {\n            throw new Error('Tópico é obrigatório');\n        }\n\n        // Inicializar histórico se não existir\n        if (!topico.historicoRevisoes) {\n            topico.historicoRevisoes = [];\n        }\n\n        // Adicionar revisão ao histórico\n        const revisao = {\n            data: dataRevisao.toISOString(),\n            dificuldade: dificuldade,\n            intervalo: this._getIntervalo(topico.historicoRevisoes.length)\n        };\n\n        topico.historicoRevisoes.push(revisao);\n        topico.ultimaRevisao = dataRevisao.toISOString();\n\n        // Ajustar intervalo baseado na dificuldade\n        const proxima = this.calcularProximaRevisao(topico, dataRevisao);\n        \n        // Se dificuldade alta, reduzir intervalo\n        if (dificuldade >= 4) {\n            const intervaloAtual = proxima.intervalo;\n            const novoIntervalo = Math.max(1, Math.floor(intervaloAtual * 0.7));\n            const novaData = new Date(dataRevisao);\n            novaData.setDate(novaData.getDate() + novoIntervalo);\n            topico.proximaRevisao = novaData.toISOString();\n        } else {\n            topico.proximaRevisao = proxima.proximaRevisao;\n        }\n\n        // Se dificuldade muito baixa, aumentar intervalo\n        if (dificuldade <= 2 && topico.historicoRevisoes.length > 1) {\n            const intervaloAtual = proxima.intervalo;\n            const novoIntervalo = Math.min(30, Math.floor(intervaloAtual * 1.3));\n            const novaData = new Date(dataRevisao);\n            novaData.setDate(novaData.getDate() + novoIntervalo);\n            topico.proximaRevisao = novaData.toISOString();\n        }\n\n        return topico;\n    }\n\n    /**\n     * Verifica se revisão está pendente\n     * @param {Object} topico - Tópico a verificar\n     * @param {Date} dataAtual - Data atual (opcional)\n     * @returns {boolean}\n     */\n    isRevisaoPendente(topico, dataAtual = new Date()) {\n        if (!topico || !topico.proximaRevisao) {\n            return false;\n        }\n\n        const revisaoDate = new Date(topico.proximaRevisao);\n        return revisaoDate <= dataAtual;\n    }\n\n    /**\n     * Obtém revisões pendentes de uma lista de tópicos\n     * @param {Array} topicos - Lista de tópicos\n     * @returns {Array} Tópicos com revisão pendente\n     */\n    getRevisoesPendentes(topicos) {\n        if (!Array.isArray(topicos)) {\n            return [];\n        }\n\n        return topicos\n            .filter(t => this.isRevisaoPendente(t))\n            .sort((a, b) => {\n                const aDate = new Date(a.proximaRevisao);\n                const bDate = new Date(b.proximaRevisao);\n                return aDate - bDate; // Mais antigas primeiro\n            });\n    }\n\n    /**\n     * Obtém estatísticas de revisão\n     * @param {Array} topicos - Lista de tópicos\n     * @returns {Object} Estatísticas\n     */\n    getEstatisticas(topicos) {\n        if (!Array.isArray(topicos)) {\n            return {\n                total: 0,\n                pendentes: 0,\n                hoje: 0,\n                estaSemana: 0,\n                proximaSemana: 0\n            };\n        }\n\n        const hoje = new Date();\n        hoje.setHours(0, 0, 0, 0);\n        \n        const fimSemana = new Date(hoje);\n        fimSemana.setDate(fimSemana.getDate() + 7);\n        \n        const fimProximaSemana = new Date(hoje);\n        fimProximaSemana.setDate(fimProximaSemana.getDate() + 14);\n\n        const stats = {\n            total: topicos.filter(t => t.proximaRevisao).length,\n            pendentes: 0,\n            hoje: 0,\n            estaSemana: 0,\n            proximaSemana: 0\n        };\n\n        topicos.forEach(topico => {\n            if (!topico.proximaRevisao) return;\n\n            const revisaoDate = new Date(topico.proximaRevisao);\n            \n            if (revisaoDate <= hoje) {\n                stats.pendentes++;\n            }\n            \n            if (revisaoDate.toDateString() === hoje.toDateString()) {\n                stats.hoje++;\n            }\n            \n            if (revisaoDate > hoje && revisaoDate <= fimSemana) {\n                stats.estaSemana++;\n            }\n            \n            if (revisaoDate > fimSemana && revisaoDate <= fimProximaSemana) {\n                stats.proximaSemana++;\n            }\n        });\n\n        return stats;\n    }\n\n    /**\n     * Agenda revisão inicial ao concluir tópico\n     * @param {Object} topico - Tópico concluído\n     * @param {Date} dataConclusao - Data de conclusão (opcional)\n     * @returns {Object} Tópico atualizado\n     */\n    agendarRevisaoInicial(topico, dataConclusao = new Date()) {\n        if (!topico) {\n            throw new Error('Tópico é obrigatório');\n        }\n\n        topico.concluidoEm = dataConclusao.toISOString();\n        topico.status = 'Concluído';\n        \n        const proxima = this.calcularProximaRevisao(topico, dataConclusao);\n        topico.proximaRevisao = proxima.proximaRevisao;\n\n        return topico;\n    }\n}\n\n// Export ES6\nexport { RevisaoEspacada };\nexport default RevisaoEspacada;\n\n// Export para uso global (compatibilidade)\nif (typeof module !== 'undefined' && module.exports) {\n    module.exports = RevisaoEspacada;\n}\n\n\n"],"names":["RevisaoEspacada","options","topico","dataAtual","revisoesFeitas","intervalo","dataBase","proximaRevisao","tentativa","revisaoDate","concluidoDate","diasEntre","dificuldade","dataRevisao","revisao","proxima","intervaloAtual","novoIntervalo","novaData","topicos","t","b","aDate","bDate","hoje","fimSemana","fimProximaSemana","stats","dataConclusao"],"mappings":"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"}