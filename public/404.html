<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <title>Redirecionando...</title>
    <meta name="robots" content="noindex" />
    <style>
        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
            background: #050505;
            color: #f5f5f5;
        }
    </style>
</head>

<body>
    <p>Redirecionando aplicação SPA...</p>
    <script>
        (function () {
            var BASE_KEY = 'GERENCIADOR_PEDRO_BASE_PATH';
            var REDIRECT_KEY = 'GERENCIADOR_PEDRO_PENDING_ROUTE';
            var fallbackPath = window.location.pathname + window.location.search + window.location.hash;

            try {
                sessionStorage.setItem(REDIRECT_KEY, fallbackPath);
            } catch (error) {
                // Ignorar storage indisponível (modo privado, etc)
            }

            var storedBase = null;
            try {
                storedBase = sessionStorage.getItem(BASE_KEY) || localStorage.getItem(BASE_KEY);
            } catch (error) {
                storedBase = null;
            }

            var basePath = storedBase || deriveBaseFromPath(window.location.pathname) || '/';
            if (!basePath.endsWith('/')) {
                basePath += '/';
            }
            if (!basePath.startsWith('/')) {
                basePath = '/' + basePath;
            }

            window.location.replace(basePath);

            function deriveBaseFromPath(pathname) {
                if (!pathname || pathname === '/') {
                    return '/';
                }
                var segments = pathname.split('/').filter(Boolean);
                if (segments.length === 0) {
                    return '/';
                }
                return '/' + segments[0] + '/';
            }
        })();
    </script>
    <noscript>
        <p>Ative o JavaScript e acesse a raiz do site para continuar.</p>
    </noscript>
</body>

</html>

