{"version":3,"file":"TaskEditModal-BpBB0i5P.js","sources":["../../src/components/TaskEditModal.js"],"sourcesContent":["/**\n * Modal de Edição de Tarefa\n * Componente para editar tarefas do kanban de projetos\n */\n\nexport class TaskEditModal {\n    constructor() {\n        this.modal = null;\n        this.currentTask = null;\n        this.onSave = null;\n        this.init();\n    }\n\n    init() {\n        // Criar modal se não existir\n        if (document.getElementById('task-edit-modal')) {\n            this.modal = document.getElementById('task-edit-modal');\n        } else {\n            this.modal = document.createElement('div');\n            this.modal.id = 'task-edit-modal';\n            this.modal.className = 'task-edit-modal';\n            this.modal.style.display = 'none';\n            document.body.appendChild(this.modal);\n        }\n\n        this.render();\n        this.setupEventListeners();\n    }\n\n    render() {\n        this.modal.innerHTML = `\n            <div class=\"task-edit-modal-overlay\"></div>\n            <div class=\"task-edit-modal-content\">\n                <div class=\"task-edit-modal-header\">\n                    <h2 id=\"task-edit-modal-title\">Editar Tarefa</h2>\n                    <button class=\"task-edit-modal-close\" aria-label=\"Fechar\">✕</button>\n                </div>\n                <div class=\"task-edit-modal-body\">\n                    <div class=\"form-group\">\n                        <label for=\"task-edit-titulo\">Título *</label>\n                        <input \n                            type=\"text\" \n                            id=\"task-edit-titulo\" \n                            class=\"input\" \n                            required \n                            placeholder=\"Título da tarefa\"\n                        />\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"task-edit-descricao\">Descrição</label>\n                        <textarea \n                            id=\"task-edit-descricao\" \n                            class=\"input\" \n                            rows=\"4\" \n                            placeholder=\"Descrição da tarefa\"\n                        ></textarea>\n                    </div>\n                    <div class=\"form-row\">\n                        <div class=\"form-group\">\n                            <label for=\"task-edit-prioridade\">Prioridade</label>\n                            <select id=\"task-edit-prioridade\" class=\"input\">\n                                <option value=\"baixa\">Baixa</option>\n                                <option value=\"media\" selected>Média</option>\n                                <option value=\"alta\">Alta</option>\n                                <option value=\"urgente\">Urgente</option>\n                            </select>\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"task-edit-responsavel\">Responsável</label>\n                            <input \n                                type=\"text\" \n                                id=\"task-edit-responsavel\" \n                                class=\"input\" \n                                placeholder=\"Nome do responsável\"\n                            />\n                        </div>\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"task-edit-tags\">Tags (separadas por vírgula)</label>\n                        <input \n                            type=\"text\" \n                            id=\"task-edit-tags\" \n                            class=\"input\" \n                            placeholder=\"ex: importante, frontend, bloqueado\"\n                        />\n                    </div>\n                    <div class=\"form-group\">\n                        <label for=\"task-edit-status\">Status</label>\n                        <select id=\"task-edit-status\" class=\"input\">\n                            <option value=\"todo\">A Fazer</option>\n                            <option value=\"doing\">Fazendo</option>\n                            <option value=\"done\">Feito</option>\n                        </select>\n                    </div>\n                    <div class=\"form-row\" id=\"task-edit-time-row\" style=\"display: none;\">\n                        <div class=\"form-group\">\n                            <label for=\"task-edit-date\">Data</label>\n                            <input \n                                type=\"date\" \n                                id=\"task-edit-date\" \n                                class=\"input\"\n                            />\n                        </div>\n                        <div class=\"form-group\">\n                            <label for=\"task-edit-time\">Hora</label>\n                            <input \n                                type=\"time\" \n                                id=\"task-edit-time\" \n                                class=\"input\"\n                            />\n                        </div>\n                    </div>\n                </div>\n                <div class=\"task-edit-modal-footer\">\n                    <button class=\"btn btn-secondary\" id=\"task-edit-cancel\">Cancelar</button>\n                    <button class=\"btn btn-primary\" id=\"task-edit-save\">Salvar</button>\n                </div>\n            </div>\n        `;\n    }\n\n    setupEventListeners() {\n        const overlay = this.modal.querySelector('.task-edit-modal-overlay');\n        const closeBtn = this.modal.querySelector('.task-edit-modal-close');\n        const cancelBtn = this.modal.querySelector('#task-edit-cancel');\n        const saveBtn = this.modal.querySelector('#task-edit-save');\n\n        const close = () => this.close();\n\n        if (overlay) overlay.addEventListener('click', close);\n        if (closeBtn) closeBtn.addEventListener('click', close);\n        if (cancelBtn) cancelBtn.addEventListener('click', close);\n\n        if (saveBtn) {\n            saveBtn.addEventListener('click', () => this.handleSave());\n        }\n\n        // Fechar com ESC\n        document.addEventListener('keydown', (e) => {\n            if (e.key === 'Escape' && this.modal.style.display !== 'none') {\n                close();\n            }\n        });\n    }\n\n    open(task, onSave) {\n        if (!task) return;\n\n        this.currentTask = task;\n        this.onSave = onSave;\n\n        // Atualizar título do modal\n        const titleEl = this.modal.querySelector('#task-edit-modal-title');\n        if (titleEl) {\n            // Verificar se é uma nova tarefa (sem id ou com título padrão)\n            const isNew = !task.id || task.titulo === 'Nova Tarefa';\n            titleEl.textContent = isNew ? 'Criar Tarefa' : 'Editar Tarefa';\n        }\n\n        // Preencher campos\n        const tituloInput = this.modal.querySelector('#task-edit-titulo');\n        const descricaoInput = this.modal.querySelector('#task-edit-descricao');\n        const prioridadeSelect = this.modal.querySelector('#task-edit-prioridade');\n        const responsavelInput = this.modal.querySelector('#task-edit-responsavel');\n        const tagsInput = this.modal.querySelector('#task-edit-tags');\n        const statusSelect = this.modal.querySelector('#task-edit-status');\n        const dateInput = this.modal.querySelector('#task-edit-date');\n        const timeInput = this.modal.querySelector('#task-edit-time');\n        const timeRow = this.modal.querySelector('#task-edit-time-row');\n\n        if (tituloInput) tituloInput.value = task.titulo || task.nome || '';\n        if (descricaoInput) descricaoInput.value = task.descricao || '';\n        if (prioridadeSelect) {\n            const prioridade = (task.prioridade || 'media').toLowerCase();\n            prioridadeSelect.value = prioridade;\n        }\n        if (responsavelInput) responsavelInput.value = task.responsavel || '';\n        if (tagsInput) {\n            const tags = task.tags || [];\n            tagsInput.value = tags.join(', ');\n        }\n        if (statusSelect) {\n            statusSelect.value = task.status || 'todo';\n        }\n\n        // Preencher data/hora se existir\n        if (task.time) {\n            const taskDate = new Date(task.time);\n            if (dateInput) {\n                dateInput.value = taskDate.toISOString().split('T')[0];\n            }\n            if (timeInput) {\n                const hours = String(taskDate.getHours()).padStart(2, '0');\n                const minutes = String(taskDate.getMinutes()).padStart(2, '0');\n                timeInput.value = `${hours}:${minutes}`;\n            }\n            if (timeRow) {\n                timeRow.style.display = 'flex';\n            }\n        } else if (task.time !== undefined) {\n            // Se time foi definido mas é null/undefined, mostrar campos\n            if (timeRow) {\n                timeRow.style.display = 'flex';\n            }\n            // Preencher com data/hora padrão (1 hora a partir de agora)\n            const defaultTime = new Date(Date.now() + 60 * 60 * 1000);\n            if (dateInput) {\n                dateInput.value = defaultTime.toISOString().split('T')[0];\n            }\n            if (timeInput) {\n                const hours = String(defaultTime.getHours()).padStart(2, '0');\n                const minutes = String(defaultTime.getMinutes()).padStart(2, '0');\n                timeInput.value = `${hours}:${minutes}`;\n            }\n        } else {\n            // Ocultar campos de data/hora se não for tarefa com horário\n            if (timeRow) {\n                timeRow.style.display = 'none';\n            }\n        }\n\n        // Mostrar modal\n        this.modal.style.display = 'flex';\n        \n        // Focar no título\n        if (tituloInput) {\n            setTimeout(() => tituloInput.focus(), 100);\n        }\n    }\n\n    close() {\n        this.modal.style.display = 'none';\n        this.currentTask = null;\n        this.onSave = null;\n    }\n\n    handleSave() {\n        const tituloInput = this.modal.querySelector('#task-edit-titulo');\n        const descricaoInput = this.modal.querySelector('#task-edit-descricao');\n        const prioridadeSelect = this.modal.querySelector('#task-edit-prioridade');\n        const responsavelInput = this.modal.querySelector('#task-edit-responsavel');\n        const tagsInput = this.modal.querySelector('#task-edit-tags');\n        const statusSelect = this.modal.querySelector('#task-edit-status');\n        const dateInput = this.modal.querySelector('#task-edit-date');\n        const timeInput = this.modal.querySelector('#task-edit-time');\n        const timeRow = this.modal.querySelector('#task-edit-time-row');\n\n        const titulo = tituloInput?.value.trim();\n        if (!titulo) {\n            alert('O título é obrigatório');\n            tituloInput?.focus();\n            return;\n        }\n\n        const updates = {\n            titulo: titulo,\n            descricao: descricaoInput?.value.trim() || '',\n            prioridade: prioridadeSelect?.value || 'media',\n            responsavel: responsavelInput?.value.trim() || '',\n            tags: tagsInput?.value\n                .split(',')\n                .map(tag => tag.trim())\n                .filter(tag => tag.length > 0),\n            status: statusSelect?.value || 'todo',\n            updatedAt: new Date().toISOString()\n        };\n\n        // Processar data/hora se os campos estiverem visíveis\n        if (timeRow && timeRow.style.display !== 'none') {\n            if (dateInput?.value && timeInput?.value) {\n                const dateStr = dateInput.value;\n                const timeStr = timeInput.value;\n                const dateTime = new Date(`${dateStr}T${timeStr}`);\n                updates.time = dateTime.toISOString();\n            } else if (this.currentTask.time !== undefined) {\n                // Se tinha time mas foi removido, definir como null\n                updates.time = null;\n            }\n        } else if (this.currentTask.time !== undefined) {\n            // Se tinha time mas os campos não estão visíveis, manter o time original\n            updates.time = this.currentTask.time;\n        }\n\n        // Se mudou para \"done\" e não tinha dataConclusao, adicionar\n        if (updates.status === 'done' && !this.currentTask.dataConclusao) {\n            updates.dataConclusao = new Date().toISOString();\n        }\n        // Se mudou de \"done\" para outro status, remover dataConclusao\n        if (updates.status !== 'done' && this.currentTask.status === 'done') {\n            updates.dataConclusao = null;\n        }\n\n        if (this.onSave) {\n            this.onSave(this.currentTask, updates);\n        }\n\n        this.close();\n    }\n}\n\n// Singleton\nexport const taskEditModal = new TaskEditModal();\n\n"],"names":["TaskEditModal","overlay","closeBtn","cancelBtn","saveBtn","close","e","task","onSave","titleEl","isNew","tituloInput","descricaoInput","prioridadeSelect","responsavelInput","tagsInput","statusSelect","dateInput","timeInput","timeRow","prioridade","tags","taskDate","hours","minutes","defaultTime","titulo","updates","tag","dateStr","timeStr","dateTime","taskEditModal"],"mappings":"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"}