{"version":3,"file":"PomodoroTimer-CWgRpmEF.js","sources":["../../src/components/estudos/PomodoroTimer.js"],"sourcesContent":["/**\n * TASK-016: Timer Pomodoro Integrado\n * \n * Cron√¥metro para sess√µes de estudo com:\n * - Timer configur√°vel (25min padr√£o)\n * - Pausa/Resume\n * - Som ao finalizar\n * - Auto-save progresso\n * - Modo foco\n */\n\nclass PomodoroTimer {\n    constructor(options = {}) {\n        this.duration = options.duration || 25 * 60; // 25 minutos em segundos\n        this.shortBreak = options.shortBreak || 5 * 60; // 5 minutos\n        this.longBreak = options.longBreak || 15 * 60; // 15 minutos\n        this.autoSaveInterval = options.autoSaveInterval || 5 * 60; // 5 minutos\n        \n        this.timeRemaining = this.duration;\n        this.isRunning = false;\n        this.isPaused = false;\n        this.mode = 'work'; // 'work', 'shortBreak', 'longBreak'\n        this.pomodorosCompleted = 0;\n        \n        this.intervalId = null;\n        this.autoSaveId = null;\n        this.startTime = null;\n        this.pausedTime = 0;\n        \n        this.onTick = options.onTick || (() => {});\n        this.onComplete = options.onComplete || (() => {});\n        this.onAutoSave = options.onAutoSave || (() => {});\n        \n        this._createUI();\n        this._attachEvents();\n    }\n\n    /**\n     * Cria interface do timer\n     */\n    _createUI() {\n        this.container = document.createElement('div');\n        this.container.className = 'pomodoro-timer';\n        this.container.innerHTML = `\n            <div class=\"pomodoro-container\">\n                <div class=\"pomodoro-display\">\n                    <div class=\"pomodoro-time\" id=\"pomodoroTime\">25:00</div>\n                    <div class=\"pomodoro-mode\" id=\"pomodoroMode\">Trabalho</div>\n                </div>\n                \n                <div class=\"pomodoro-controls\">\n                    <button class=\"pomodoro-btn\" id=\"pomodoroStart\">‚ñ∂Ô∏è Iniciar</button>\n                    <button class=\"pomodoro-btn\" id=\"pomodoroPause\" style=\"display:none\">‚è∏Ô∏è Pausar</button>\n                    <button class=\"pomodoro-btn\" id=\"pomodoroReset\">üîÑ Resetar</button>\n                    <button class=\"pomodoro-btn\" id=\"pomodoroSkip\">‚è≠Ô∏è Pular</button>\n                </div>\n                \n                <div class=\"pomodoro-settings\">\n                    <label>\n                        Dura√ß√£o (min):\n                        <input type=\"number\" id=\"pomodoroDuration\" value=\"25\" min=\"1\" max=\"60\">\n                    </label>\n                    <button class=\"pomodoro-btn-small\" id=\"pomodoroFocusMode\">üéØ Modo Foco</button>\n                </div>\n                \n                <div class=\"pomodoro-stats\">\n                    <div class=\"pomodoro-stat\">\n                        <span class=\"pomodoro-stat-label\">Pomodoros:</span>\n                        <span class=\"pomodoro-stat-value\" id=\"pomodoroCount\">0</span>\n                    </div>\n                </div>\n            </div>\n        `;\n    }\n\n    /**\n     * Anexa eventos\n     */\n    _attachEvents() {\n        const startBtn = this.container.querySelector('#pomodoroStart');\n        const pauseBtn = this.container.querySelector('#pomodoroPause');\n        const resetBtn = this.container.querySelector('#pomodoroReset');\n        const skipBtn = this.container.querySelector('#pomodoroSkip');\n        const focusBtn = this.container.querySelector('#pomodoroFocusMode');\n        const durationInput = this.container.querySelector('#pomodoroDuration');\n\n        startBtn.addEventListener('click', () => this.start());\n        pauseBtn.addEventListener('click', () => this.pause());\n        resetBtn.addEventListener('click', () => this.reset());\n        skipBtn.addEventListener('click', () => this.skip());\n        focusBtn.addEventListener('click', () => this.toggleFocusMode());\n        \n        durationInput.addEventListener('change', (e) => {\n            const minutes = parseInt(e.target.value);\n            if (minutes > 0 && minutes <= 60) {\n                this.setDuration(minutes * 60);\n            }\n        });\n    }\n\n    /**\n     * Inicia o timer\n     */\n    start() {\n        if (this.isRunning) return;\n\n        this.isRunning = true;\n        this.isPaused = false;\n        this.startTime = Date.now() - this.pausedTime;\n        \n        this.intervalId = setInterval(() => {\n            this._tick();\n        }, 1000);\n\n        // Auto-save\n        this.autoSaveId = setInterval(() => {\n            this._autoSave();\n        }, this.autoSaveInterval * 1000);\n\n        this._updateUI();\n        this._tick(); // Primeiro tick imediato\n    }\n\n    /**\n     * Pausa o timer\n     */\n    pause() {\n        if (!this.isRunning || this.isPaused) return;\n\n        this.isPaused = true;\n        this.pausedTime = Date.now() - this.startTime;\n        \n        if (this.intervalId) {\n            clearInterval(this.intervalId);\n            this.intervalId = null;\n        }\n\n        this._updateUI();\n    }\n\n    /**\n     * Resume o timer\n     */\n    resume() {\n        if (!this.isPaused) return;\n\n        this.isPaused = false;\n        this.startTime = Date.now() - this.pausedTime;\n        \n        this.intervalId = setInterval(() => {\n            this._tick();\n        }, 1000);\n\n        this._updateUI();\n    }\n\n    /**\n     * Reseta o timer\n     */\n    reset() {\n        this.stop();\n        this.timeRemaining = this.duration;\n        this.pausedTime = 0;\n        this._updateUI();\n    }\n\n    /**\n     * Para o timer\n     */\n    stop() {\n        this.isRunning = false;\n        this.isPaused = false;\n        \n        if (this.intervalId) {\n            clearInterval(this.intervalId);\n            this.intervalId = null;\n        }\n        \n        if (this.autoSaveId) {\n            clearInterval(this.autoSaveId);\n            this.autoSaveId = null;\n        }\n        \n        this.startTime = null;\n        this.pausedTime = 0;\n    }\n\n    /**\n     * Pula para o pr√≥ximo modo\n     */\n    skip() {\n        this.stop();\n        \n        if (this.mode === 'work') {\n            this.pomodorosCompleted++;\n            // Alternar entre short e long break\n            if (this.pomodorosCompleted % 4 === 0) {\n                this.mode = 'longBreak';\n                this.timeRemaining = this.longBreak;\n            } else {\n                this.mode = 'shortBreak';\n                this.timeRemaining = this.shortBreak;\n            }\n        } else {\n            this.mode = 'work';\n            this.timeRemaining = this.duration;\n        }\n        \n        this._updateUI();\n    }\n\n    /**\n     * Tick do timer\n     */\n    _tick() {\n        if (!this.isRunning || this.isPaused) return;\n\n        const elapsed = Math.floor((Date.now() - this.startTime) / 1000);\n        this.timeRemaining = Math.max(0, this.duration - elapsed);\n\n        this._updateUI();\n        this.onTick(this.timeRemaining, this.mode);\n\n        if (this.timeRemaining <= 0) {\n            this._complete();\n        }\n    }\n\n    /**\n     * Completa o timer\n     */\n    _complete() {\n        this.stop();\n        \n        if (this.mode === 'work') {\n            this.pomodorosCompleted++;\n        }\n        \n        this._playSound();\n        this.onComplete(this.mode, this.pomodorosCompleted);\n        \n        // Auto-iniciar break se configurado\n        // Por enquanto, apenas notifica\n        this._updateUI();\n    }\n\n    /**\n     * Auto-save do progresso\n     */\n    _autoSave() {\n        if (!this.isRunning || this.isPaused) return;\n\n        const elapsed = Math.floor((Date.now() - this.startTime) / 1000);\n        const progress = {\n            timeRemaining: this.timeRemaining,\n            elapsed: elapsed,\n            mode: this.mode,\n            timestamp: new Date().toISOString()\n        };\n\n        this.onAutoSave(progress);\n    }\n\n    /**\n     * Atualiza UI\n     */\n    _updateUI() {\n        const timeEl = this.container.querySelector('#pomodoroTime');\n        const modeEl = this.container.querySelector('#pomodoroMode');\n        const startBtn = this.container.querySelector('#pomodoroStart');\n        const pauseBtn = this.container.querySelector('#pomodoroPause');\n        const countEl = this.container.querySelector('#pomodoroCount');\n\n        // Atualizar tempo\n        const minutes = Math.floor(this.timeRemaining / 60);\n        const seconds = this.timeRemaining % 60;\n        timeEl.textContent = `${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;\n\n        // Atualizar modo\n        const modeText = {\n            'work': 'Trabalho',\n            'shortBreak': 'Pausa Curta',\n            'longBreak': 'Pausa Longa'\n        };\n        modeEl.textContent = modeText[this.mode] || 'Trabalho';\n\n        // Atualizar bot√µes\n        if (this.isRunning && !this.isPaused) {\n            startBtn.style.display = 'none';\n            pauseBtn.style.display = 'inline-block';\n        } else {\n            startBtn.style.display = 'inline-block';\n            pauseBtn.style.display = 'none';\n        }\n\n        // Atualizar contador\n        countEl.textContent = this.pomodorosCompleted;\n\n        // Adicionar classe de warning quando < 1 minuto\n        timeEl.classList.toggle('warning', this.timeRemaining < 60);\n    }\n\n    /**\n     * Toggle modo foco\n     */\n    toggleFocusMode() {\n        const isFocus = document.body.classList.toggle('focus-mode');\n        const btn = this.container.querySelector('#pomodoroFocusMode');\n        btn.textContent = isFocus ? 'üëÅÔ∏è Sair do Foco' : 'üéØ Modo Foco';\n    }\n\n    /**\n     * Define dura√ß√£o\n     */\n    setDuration(seconds) {\n        if (this.isRunning) {\n            console.warn('N√£o √© poss√≠vel alterar dura√ß√£o enquanto o timer est√° rodando');\n            return;\n        }\n        \n        this.duration = seconds;\n        this.timeRemaining = seconds;\n        this._updateUI();\n    }\n\n    /**\n     * Toca som de conclus√£o\n     */\n    _playSound() {\n        // Criar audio context para tocar som\n        try {\n            const audioContext = new (window.AudioContext || window.webkitAudioContext)();\n            const oscillator = audioContext.createOscillator();\n            const gainNode = audioContext.createGain();\n\n            oscillator.connect(gainNode);\n            gainNode.connect(audioContext.destination);\n\n            oscillator.frequency.value = 800;\n            oscillator.type = 'sine';\n\n            gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);\n            gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);\n\n            oscillator.start(audioContext.currentTime);\n            oscillator.stop(audioContext.currentTime + 0.5);\n        } catch (e) {\n            console.warn('N√£o foi poss√≠vel tocar som', e);\n        }\n    }\n\n    /**\n     * Obt√©m elemento do container\n     */\n    getElement() {\n        return this.container;\n    }\n\n    /**\n     * Destr√≥i o timer\n     */\n    destroy() {\n        this.stop();\n        if (this.container && this.container.parentNode) {\n            this.container.parentNode.removeChild(this.container);\n        }\n    }\n}\n\n// Export ES6\nexport { PomodoroTimer };\nexport default PomodoroTimer;\n\n// Export para uso global (compatibilidade)\nif (typeof module !== 'undefined' && module.exports) {\n    module.exports = PomodoroTimer;\n}\n\n\n"],"names":["PomodoroTimer","options","startBtn","pauseBtn","resetBtn","skipBtn","focusBtn","durationInput","e","minutes","elapsed","progress","timeEl","modeEl","countEl","seconds","modeText","isFocus","btn","audioContext","oscillator","gainNode"],"mappings":"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"}