{"version":3,"file":"NotasRapidas-DCoJvJV-.js","sources":["../../src/components/estudos/NotasRapidas.js"],"sourcesContent":["/**\n * TASK-017: Campo de Notas R√°pidas\n * \n * √Årea para anota√ß√µes durante estudo com:\n * - Markdown b√°sico\n * - Auto-save a cada 30s\n * - Snippets/templates\n * - Exportar como .md\n * - Busca em notas antigas\n */\n\nimport {\n    firebaseCache\n} from '../../services/firebase-cache.js';\n\nclass NotasRapidas {\n    constructor(options = {}) {\n        this.container = options.container || document.body;\n        this.topicoId = options.topicoId || null;\n        this.autoSaveInterval = options.autoSaveInterval || 30000; // 30 segundos\n        this.onSave = options.onSave || (() => {});\n        this.onChange = options.onChange || (() => {});\n\n        this.content = '';\n        this.lastSaved = null;\n        this.autoSaveId = null;\n        this.isDirty = false;\n\n        this.templates = {\n            'sessao': `# Sess√£o de Estudo\n\n## O que aprendi\n- \n- \n\n## D√∫vidas\n- \n\n## Pr√≥ximos passos\n- `,\n            'revisao': `# Revis√£o\n\n## O que lembrei\n- \n\n## O que esqueci\n- \n\n## Pontos importantes\n- `,\n            'resumo': `# Resumo\n\n## Conceitos principais\n1. \n2. \n3. \n\n## Exemplos\n- \n\n## Aplica√ß√µes pr√°ticas\n- `\n        };\n\n        this._createUI();\n        this._attachEvents();\n        // Carregar conte√∫do assincronamente\n        this._loadContent().catch(err => {\n            console.error('Erro ao carregar conte√∫do:', err);\n        });\n    }\n\n    /**\n     * Cria interface\n     */\n    _createUI() {\n        this.wrapper = document.createElement('div');\n        this.wrapper.className = 'notas-rapidas';\n        this.wrapper.innerHTML = `\n            <div class=\"notas-container\">\n                <div class=\"notas-header\">\n                    <h3>üìù Notas R√°pidas</h3>\n                    <div class=\"notas-actions\">\n                        <button class=\"notas-btn\" id=\"notasTemplate\" title=\"Inserir template\">üìÑ</button>\n                        <button class=\"notas-btn\" id=\"notasExport\" title=\"Exportar\">üíæ</button>\n                        <button class=\"notas-btn\" id=\"notasSearch\" title=\"Buscar\">üîç</button>\n                        <span class=\"notas-status\" id=\"notasStatus\">Salvo</span>\n                    </div>\n                </div>\n                \n                <div class=\"notas-editor-container\">\n                    <textarea \n                        class=\"notas-editor\" \n                        id=\"notasEditor\"\n                        placeholder=\"Digite suas anota√ß√µes aqui...&#10;&#10;Suporta Markdown:&#10;**negrito** *it√°lico*&#10;# T√≠tulo&#10;- Lista\"\n                    ></textarea>\n                    <div class=\"notas-preview\" id=\"notasPreview\"></div>\n                </div>\n                \n                <div class=\"notas-toolbar\">\n                    <button class=\"notas-toolbar-btn\" data-insert=\"**texto**\">B</button>\n                    <button class=\"notas-toolbar-btn\" data-insert=\"*texto*\">I</button>\n                    <button class=\"notas-toolbar-btn\" data-insert=\"# T√≠tulo\">H1</button>\n                    <button class=\"notas-toolbar-btn\" data-insert=\"- Item\">Lista</button>\n                    <button class=\"notas-toolbar-btn\" data-insert=\"\\`\\`\\`&#10;c√≥digo&#10;\\`\\`\\`\">Code</button>\n                </div>\n            </div>\n            \n            <!-- Modal de templates -->\n            <div class=\"notas-modal\" id=\"notasTemplateModal\" style=\"display:none\">\n                <div class=\"notas-modal-content\">\n                    <h4>Escolha um template</h4>\n                    <div class=\"notas-templates-list\" id=\"notasTemplatesList\"></div>\n                    <button class=\"notas-btn\" id=\"notasTemplateCancel\">Cancelar</button>\n                </div>\n            </div>\n            \n            <!-- Modal de busca -->\n            <div class=\"notas-modal\" id=\"notasSearchModal\" style=\"display:none\">\n                <div class=\"notas-modal-content\">\n                    <h4>Buscar em notas</h4>\n                    <input type=\"text\" class=\"notas-search-input\" id=\"notasSearchInput\" placeholder=\"Digite para buscar...\">\n                    <div class=\"notas-search-results\" id=\"notasSearchResults\"></div>\n                    <button class=\"notas-btn\" id=\"notasSearchCancel\">Fechar</button>\n                </div>\n            </div>\n        `;\n\n        this.container.appendChild(this.wrapper);\n        this.editor = this.wrapper.querySelector('#notasEditor');\n        this.preview = this.wrapper.querySelector('#notasPreview');\n        this.status = this.wrapper.querySelector('#notasStatus');\n    }\n\n    /**\n     * Anexa eventos\n     */\n    _attachEvents() {\n        // Editor events\n        this.editor.addEventListener('input', () => this._handleInput());\n        this.editor.addEventListener('keydown', (e) => this._handleKeyDown(e));\n\n        // Toolbar buttons\n        this.wrapper.querySelectorAll('.notas-toolbar-btn').forEach(btn => {\n            btn.addEventListener('click', () => {\n                const insert = btn.dataset.insert;\n                this._insertText(insert);\n            });\n        });\n\n        // Action buttons\n        this.wrapper.querySelector('#notasTemplate').addEventListener('click', () => this._showTemplateModal());\n        this.wrapper.querySelector('#notasExport').addEventListener('click', () => this._exportMarkdown());\n        this.wrapper.querySelector('#notasSearch').addEventListener('click', () => this._showSearchModal());\n        this.wrapper.querySelector('#notasTemplateCancel').addEventListener('click', () => this._closeTemplateModal());\n        this.wrapper.querySelector('#notasSearchCancel').addEventListener('click', () => this._closeSearchModal());\n\n        // Auto-save\n        this._startAutoSave();\n    }\n\n    /**\n     * Handler de input\n     */\n    _handleInput() {\n        this.content = this.editor.value;\n        this.isDirty = true;\n        this._updatePreview();\n        this._updateStatus('Editando...');\n        this.onChange(this.content);\n    }\n\n    /**\n     * Handler de teclas\n     */\n    _handleKeyDown(e) {\n        // Tab para indenta√ß√£o\n        if (e.key === 'Tab' && !e.shiftKey) {\n            e.preventDefault();\n            this._insertText('  ', true);\n            return;\n        }\n\n        // Ctrl+S para salvar\n        if ((e.ctrlKey || e.metaKey) && e.key === 's') {\n            e.preventDefault();\n            this._save();\n            return;\n        }\n    }\n\n    /**\n     * Insere texto no cursor\n     */\n    _insertText(text, replaceSelection = false) {\n        const start = this.editor.selectionStart;\n        const end = this.editor.selectionEnd;\n        const selectedText = this.editor.value.substring(start, end);\n\n        let insertText = text;\n        if (text.includes('texto') && selectedText) {\n            insertText = text.replace('texto', selectedText);\n        }\n\n        const newValue =\n            this.editor.value.substring(0, start) +\n            insertText +\n            this.editor.value.substring(end);\n\n        this.editor.value = newValue;\n        this.editor.focus();\n\n        // Reposicionar cursor\n        const newPos = replaceSelection ?\n            start + insertText.length :\n            start + insertText.length;\n        this.editor.setSelectionRange(newPos, newPos);\n\n        this._handleInput();\n    }\n\n    /**\n     * Atualiza preview\n     */\n    _updatePreview() {\n        if (!this.preview) return;\n\n        const markdown = this.content;\n        const html = this._markdownToHtml(markdown);\n        this.preview.innerHTML = html;\n    }\n\n    /**\n     * Converte markdown b√°sico para HTML\n     */\n    _markdownToHtml(markdown) {\n        let html = markdown;\n\n        // Headers\n        html = html.replace(/^### (.*$)/gim, '<h3>$1</h3>');\n        html = html.replace(/^## (.*$)/gim, '<h2>$1</h2>');\n        html = html.replace(/^# (.*$)/gim, '<h1>$1</h1>');\n\n        // Bold\n        html = html.replace(/\\*\\*(.*?)\\*\\*/g, '<strong>$1</strong>');\n\n        // Italic\n        html = html.replace(/\\*(.*?)\\*/g, '<em>$1</em>');\n\n        // Code blocks\n        html = html.replace(/```([\\s\\S]*?)```/g, '<pre><code>$1</code></pre>');\n        html = html.replace(/`(.*?)`/g, '<code>$1</code>');\n\n        // Lists\n        html = html.replace(/^- (.*$)/gim, '<li>$1</li>');\n        html = html.replace(/^\\d+\\. (.*$)/gim, '<li>$1</li>');\n        html = html.replace(/(<li>.*<\\/li>)/s, '<ul>$1</ul>');\n\n        // Line breaks\n        html = html.replace(/\\n/g, '<br>');\n\n        return html || '<p class=\"notas-empty\">Nenhuma nota ainda...</p>';\n    }\n\n    /**\n     * Inicia auto-save\n     */\n    _startAutoSave() {\n        this.autoSaveId = setInterval(() => {\n            if (this.isDirty) {\n                this._save().catch(err => {\n                    console.error('Erro no auto-save:', err);\n                });\n            }\n        }, this.autoSaveInterval);\n    }\n\n    /**\n     * Salva conte√∫do\n     */\n    async _save() {\n        if (!this.isDirty) return;\n\n        const data = {\n            topicoId: this.topicoId,\n            content: this.content,\n            timestamp: new Date().toISOString()\n        };\n\n        // Salvar apenas localmente (cache)\n        const key = `notas_${this.topicoId || 'global'}`;\n        try {\n            // Salvar no cache local\n            await firebaseCache.set(key, data);\n\n            this.lastSaved = new Date();\n            this.isDirty = false;\n            this._updateStatus('Salvo');\n            this.onSave(data);\n        } catch (e) {\n            console.error('Erro ao salvar notas', e);\n            this._updateStatus('Erro ao salvar');\n        }\n    }\n\n    /**\n     * Carrega conte√∫do\n     */\n    async _loadContent() {\n        const key = `notas_${this.topicoId || 'global'}`;\n        try {\n            // Tentar carregar do cache primeiro\n            let data = await firebaseCache.get(key);\n\n            // Fallback para localStorage (migra√ß√£o)\n            if (!data) {\n                try {\n                    const stored = localStorage.getItem(key);\n                    if (stored) {\n                        data = JSON.parse(stored);\n                        // Migrar para cache\n                        await firebaseCache.set(key, data);\n                    }\n                } catch (e) {\n                    // Ignorar erros de localStorage\n                }\n            }\n\n            if (data) {\n                this.content = data.content || '';\n                this.editor.value = this.content;\n                this._updatePreview();\n                this.lastSaved = data.timestamp ? new Date(data.timestamp) : null;\n            }\n        } catch (e) {\n            console.warn('Erro ao carregar notas', e);\n        }\n    }\n\n    /**\n     * Atualiza status\n     */\n    _updateStatus(text) {\n        if (this.status) {\n            this.status.textContent = text;\n            this.status.classList.toggle('saving', text === 'Editando...');\n            this.status.classList.toggle('saved', text === 'Salvo');\n        }\n    }\n\n    /**\n     * Mostra modal de templates\n     */\n    _showTemplateModal() {\n        const modal = this.wrapper.querySelector('#notasTemplateModal');\n        const list = this.wrapper.querySelector('#notasTemplatesList');\n\n        list.innerHTML = Object.entries(this.templates)\n            .map(([name, template]) => {\n                const item = document.createElement('div');\n                item.className = 'notas-template-item';\n                item.innerHTML = `\n                    <strong>${name.charAt(0).toUpperCase() + name.slice(1)}</strong>\n                    <p>${template.split('\\n')[0]}...</p>\n                `;\n                item.addEventListener('click', () => this._insertTemplate(name));\n                return item.outerHTML;\n            })\n            .join('');\n\n        modal.style.display = 'flex';\n    }\n\n    /**\n     * Insere template\n     */\n    _insertTemplate(name) {\n        const template = this.templates[name];\n        if (template) {\n            this.editor.value = template;\n            this._handleInput();\n            this._closeTemplateModal();\n        }\n    }\n\n    /**\n     * Fecha modal de templates\n     */\n    _closeTemplateModal() {\n        const modal = this.wrapper.querySelector('#notasTemplateModal');\n        modal.style.display = 'none';\n    }\n\n    /**\n     * Mostra modal de busca\n     */\n    _showSearchModal() {\n        const modal = this.wrapper.querySelector('#notasSearchModal');\n        const input = this.wrapper.querySelector('#notasSearchInput');\n        const results = this.wrapper.querySelector('#notasSearchResults');\n\n        modal.style.display = 'flex';\n        input.focus();\n        input.value = '';\n        results.innerHTML = '';\n\n        const searchHandler = () => {\n            const query = input.value.toLowerCase();\n            if (query.length < 2) {\n                results.innerHTML = '';\n                return;\n            }\n\n            const matches = this._searchNotes(query);\n            results.innerHTML = matches.length > 0 ?\n                matches.map(m => `\n                    <div class=\"notas-search-result\">\n                        <strong>${m.topico || 'Global'}</strong>\n                        <p>${m.preview}</p>\n                    </div>\n                `).join('') :\n                '<p>Nenhuma nota encontrada</p>';\n        };\n\n        // Remover listener anterior se existir\n        input.removeEventListener('input', this._searchHandler);\n        this._searchHandler = searchHandler;\n        input.addEventListener('input', searchHandler);\n    }\n\n    /**\n     * Busca em notas\n     */\n    async _searchNotes(query) {\n        const matches = [];\n\n        try {\n            // Buscar no cache primeiro\n            const allKeys = await firebaseCache.getAllKeys();\n            const notasKeys = allKeys.filter(key => key.startsWith('notas_'));\n\n            for (const key of notasKeys) {\n                try {\n                    const data = await firebaseCache.get(key);\n                    if (data && data.content && data.content.toLowerCase().includes(query)) {\n                        matches.push({\n                            topico: key.replace('notas_', ''),\n                            preview: data.content.substring(0, 100) + '...',\n                            content: data.content\n                        });\n                    }\n                } catch (e) {\n                    console.warn(`Erro ao buscar nota ${key}:`, e);\n                }\n            }\n\n            // Fallback para localStorage (migra√ß√£o)\n            for (let i = 0; i < localStorage.length; i++) {\n                const key = localStorage.key(i);\n                if (key && key.startsWith('notas_')) {\n                    try {\n                        const data = JSON.parse(localStorage.getItem(key));\n                        if (data.content && data.content.toLowerCase().includes(query)) {\n                            // Evitar duplicatas\n                            if (!matches.find(m => m.topico === key.replace('notas_', ''))) {\n                                matches.push({\n                                    topico: key.replace('notas_', ''),\n                                    preview: data.content.substring(0, 100) + '...',\n                                    content: data.content\n                                });\n                            }\n                        }\n                    } catch (e) {\n                        // Ignorar erros\n                    }\n                }\n            }\n\n            return matches;\n        } catch (e) {\n            console.error('Erro ao buscar notas:', e);\n            return [];\n        }\n    }\n\n    /**\n     * Fecha modal de busca\n     */\n    _closeSearchModal() {\n        const modal = this.wrapper.querySelector('#notasSearchModal');\n        if (modal) {\n            modal.style.display = 'none';\n        }\n    }\n\n    /**\n     * Exporta como markdown\n     */\n    _exportMarkdown() {\n        if (!this.content) {\n            alert('Nenhuma nota para exportar');\n            return;\n        }\n\n        const blob = new Blob([this.content], {\n            type: 'text/markdown'\n        });\n        const url = URL.createObjectURL(blob);\n        const a = document.createElement('a');\n        a.href = url;\n        a.download = `notas_${this.topicoId || 'global'}_${Date.now()}.md`;\n        a.click();\n        URL.revokeObjectURL(url);\n    }\n\n    /**\n     * Define conte√∫do\n     */\n    setContent(content) {\n        this.content = content;\n        this.editor.value = content;\n        this._updatePreview();\n        this.isDirty = true;\n    }\n\n    /**\n     * Obt√©m conte√∫do\n     */\n    getContent() {\n        return this.content;\n    }\n\n    /**\n     * Define t√≥pico\n     */\n    async setTopicoId(topicoId) {\n        // Salvar conte√∫do atual antes de trocar\n        if (this.isDirty) {\n            await this._save();\n        }\n\n        this.topicoId = topicoId;\n        await this._loadContent();\n    }\n\n    /**\n     * Destr√≥i componente\n     */\n    destroy() {\n        if (this.autoSaveId) {\n            clearInterval(this.autoSaveId);\n        }\n\n        if (this.isDirty) {\n            this._save();\n        }\n\n        if (this.wrapper && this.wrapper.parentNode) {\n            this.wrapper.parentNode.removeChild(this.wrapper);\n        }\n    }\n}\n\n// Export ES6\nexport {\n    NotasRapidas\n};\nexport default NotasRapidas;\n\n// Export para uso global (compatibilidade)\nif (typeof module !== 'undefined' && module.exports) {\n    module.exports = NotasRapidas;\n}"],"names":["NotasRapidas","options","err","btn","insert","text","replaceSelection","start","end","selectedText","insertText","newValue","newPos","markdown","html","data","key","firebaseCache","e","stored","modal","list","name","template","item","input","results","searchHandler","query","matches","m","notasKeys","i","blob","url","content","topicoId"],"mappings":"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"}