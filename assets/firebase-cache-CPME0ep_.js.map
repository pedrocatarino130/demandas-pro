{"version":3,"file":"firebase-cache-CPME0ep_.js","sources":["../../src/services/firebase-cache.js"],"sourcesContent":["/**\n * Gerenciamento de Cache Local usando IndexedDB\n * Cache local para armazenamento persistente de dados da aplicação\n */\n\nimport { openDB } from 'idb';\n\nconst DB_NAME = 'gerenciador-pedro-cache';\nconst DB_VERSION = 1;\nconst STORE_NAME = 'app-data';\n\n/**\n * Abre a conexão com IndexedDB\n */\nasync function openDatabase() {\n    return openDB(DB_NAME, DB_VERSION, {\n        upgrade(db) {\n            if (!db.objectStoreNames.contains(STORE_NAME)) {\n                db.createObjectStore(STORE_NAME);\n            }\n        },\n    });\n}\n\n/**\n * Classe para gerenciar cache local\n */\nclass LocalCache {\n    constructor() {\n        this.db = null;\n        this.initialized = false;\n    }\n\n    /**\n     * Inicializa o cache\n     */\n    async init() {\n        if (this.initialized) return;\n        try {\n            this.db = await openDatabase();\n            this.initialized = true;\n            console.log('✅ Cache IndexedDB inicializado');\n        } catch (error) {\n            console.error('❌ Erro ao inicializar cache:', error);\n        }\n    }\n\n    /**\n     * Salva dados no cache\n     * @param {string} key - Chave do cache\n     * @param {any} data - Dados para salvar\n     */\n    async set(key, data) {\n        if (!this.initialized) await this.init();\n        if (!this.db) return false;\n\n        try {\n            await this.db.put(STORE_NAME, data, key);\n            return true;\n        } catch (error) {\n            console.error(`Erro ao salvar no cache (${key}):`, error);\n            return false;\n        }\n    }\n\n    /**\n     * Recupera dados do cache\n     * @param {string} key - Chave do cache\n     * @returns {Promise<any|null>} Dados ou null se não encontrado\n     */\n    async get(key) {\n        if (!this.initialized) await this.init();\n        if (!this.db) return null;\n\n        try {\n            return await this.db.get(STORE_NAME, key) || null;\n        } catch (error) {\n            console.error(`Erro ao recuperar do cache (${key}):`, error);\n            return null;\n        }\n    }\n\n    /**\n     * Remove dados do cache\n     * @param {string} key - Chave do cache\n     */\n    async remove(key) {\n        if (!this.initialized) await this.init();\n        if (!this.db) return false;\n\n        try {\n            await this.db.delete(STORE_NAME, key);\n            return true;\n        } catch (error) {\n            console.error(`Erro ao remover do cache (${key}):`, error);\n            return false;\n        }\n    }\n\n    /**\n     * Limpa todo o cache\n     */\n    async clear() {\n        if (!this.initialized) await this.init();\n        if (!this.db) return false;\n\n        try {\n            await this.db.clear(STORE_NAME);\n            return true;\n        } catch (error) {\n            console.error('Erro ao limpar cache:', error);\n            return false;\n        }\n    }\n\n    /**\n     * Verifica se uma chave existe no cache\n     * @param {string} key - Chave do cache\n     * @returns {Promise<boolean>}\n     */\n    async has(key) {\n        const data = await this.get(key);\n        return data !== null;\n    }\n\n    /**\n     * Obtém todas as chaves do cache\n     * @returns {Promise<string[]>}\n     */\n    async getAllKeys() {\n        if (!this.initialized) await this.init();\n        if (!this.db) return [];\n\n        try {\n            return await this.db.getAllKeys(STORE_NAME);\n        } catch (error) {\n            console.error('Erro ao obter chaves do cache:', error);\n            return [];\n        }\n    }\n}\n\n// Exportar instância singleton (mantém nome firebaseCache para compatibilidade)\nexport const firebaseCache = new LocalCache();\nexport default firebaseCache;\n\n"],"names":["DB_NAME","DB_VERSION","STORE_NAME","openDatabase","openDB","db","LocalCache","error","key","data","firebaseCache"],"mappings":"sCAOA,MAAMA,EAAU,0BACVC,EAAa,EACbC,EAAa,WAKnB,eAAeC,GAAe,CAC1B,OAAOC,EAAOJ,EAASC,EAAY,CAC/B,QAAQI,EAAI,CACHA,EAAG,iBAAiB,SAASH,CAAU,GACxCG,EAAG,kBAAkBH,CAAU,CAEvC,CACR,CAAK,CACL,CAKA,MAAMI,CAAW,CACb,aAAc,CACV,KAAK,GAAK,KACV,KAAK,YAAc,EACvB,CAKA,MAAM,MAAO,CACT,GAAI,MAAK,YACT,GAAI,CACA,KAAK,GAAK,MAAMH,EAAY,EAC5B,KAAK,YAAc,GACnB,QAAQ,IAAI,gCAAgC,CAChD,OAASI,EAAO,CACZ,QAAQ,MAAM,+BAAgCA,CAAK,CACvD,CACJ,CAOA,MAAM,IAAIC,EAAKC,EAAM,CAEjB,GADK,KAAK,aAAa,MAAM,KAAK,KAAI,EAClC,CAAC,KAAK,GAAI,MAAO,GAErB,GAAI,CACA,aAAM,KAAK,GAAG,IAAIP,EAAYO,EAAMD,CAAG,EAChC,EACX,OAASD,EAAO,CACZ,eAAQ,MAAM,4BAA4BC,CAAG,KAAMD,CAAK,EACjD,EACX,CACJ,CAOA,MAAM,IAAIC,EAAK,CAEX,GADK,KAAK,aAAa,MAAM,KAAK,KAAI,EAClC,CAAC,KAAK,GAAI,OAAO,KAErB,GAAI,CACA,OAAO,MAAM,KAAK,GAAG,IAAIN,EAAYM,CAAG,GAAK,IACjD,OAASD,EAAO,CACZ,eAAQ,MAAM,+BAA+BC,CAAG,KAAMD,CAAK,EACpD,IACX,CACJ,CAMA,MAAM,OAAOC,EAAK,CAEd,GADK,KAAK,aAAa,MAAM,KAAK,KAAI,EAClC,CAAC,KAAK,GAAI,MAAO,GAErB,GAAI,CACA,aAAM,KAAK,GAAG,OAAON,EAAYM,CAAG,EAC7B,EACX,OAASD,EAAO,CACZ,eAAQ,MAAM,6BAA6BC,CAAG,KAAMD,CAAK,EAClD,EACX,CACJ,CAKA,MAAM,OAAQ,CAEV,GADK,KAAK,aAAa,MAAM,KAAK,KAAI,EAClC,CAAC,KAAK,GAAI,MAAO,GAErB,GAAI,CACA,aAAM,KAAK,GAAG,MAAML,CAAU,EACvB,EACX,OAASK,EAAO,CACZ,eAAQ,MAAM,wBAAyBA,CAAK,EACrC,EACX,CACJ,CAOA,MAAM,IAAIC,EAAK,CAEX,OADa,MAAM,KAAK,IAAIA,CAAG,IACf,IACpB,CAMA,MAAM,YAAa,CAEf,GADK,KAAK,aAAa,MAAM,KAAK,KAAI,EAClC,CAAC,KAAK,GAAI,MAAO,CAAA,EAErB,GAAI,CACA,OAAO,MAAM,KAAK,GAAG,WAAWN,CAAU,CAC9C,OAASK,EAAO,CACZ,eAAQ,MAAM,iCAAkCA,CAAK,EAC9C,CAAA,CACX,CACJ,CACJ,CAGY,MAACG,EAAgB,IAAIJ"}