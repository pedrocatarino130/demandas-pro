{"version":3,"file":"store-Bg3-w4tx.js","sources":["../../src/store.js"],"sourcesContent":["/**\n * Sistema de Estado Global\n * Gerencia estado centralizado com armazenamento local (IndexedDB/localStorage)\n */\n\nimport {\n    firebaseService\n} from './services/firebase-service.js';\nimport {\n    firebaseCache\n} from './services/firebase-cache.js';\nimport {\n    firebaseSync\n} from './services/firebase-sync.js';\n\nclass Store {\n    constructor() {\n        this.state = this.getDefaultState();\n        this.subscribers = [];\n        this.saveDebounce = null;\n        this.DEBOUNCE_DELAY = 300; // ms\n        this.initialized = false;\n        this.initializing = false;\n        this.listeners = []; // Firestore listeners\n        this.userId = 'default'; // Para futuro suporte de autenticação\n\n        // Inicializar assincronamente\n        this.init();\n    }\n\n    /**\n     * Inicialização assíncrona - local + Firebase quando disponível\n     */\n    async init() {\n        if (this.initializing) return;\n        this.initializing = true;\n\n        // Inicializar cache\n        await firebaseCache.init();\n\n        // Carregar estado do cache primeiro (para mostrar algo imediatamente)\n        const cachedState = await this.loadFromCache();\n        if (cachedState) {\n            this.state = {\n                ...this.getDefaultState(),\n                ...cachedState\n            };\n            this.notify();\n        }\n\n        // Carregar dados antigos do localStorage (migração)\n        await this.migrateFromV2();\n\n        // Se Firebase está disponível, carregar e configurar sincronização\n        if (firebaseService.isAvailable()) {\n            try {\n                // Carregar do Firestore (pode sobrescrever dados locais se mais recentes)\n                await this.loadFromFirestore();\n                \n                // Configurar listeners real-time\n                this.setupRealtimeListeners();\n                \n                console.log('✅ Store inicializado (modo Firebase + local)');\n            } catch (error) {\n                console.error('⚠️ Erro ao inicializar Firebase no Store:', error);\n                console.log('✅ Store inicializado (modo local apenas)');\n            }\n        } else {\n            console.log('✅ Store inicializado (modo local)');\n        }\n\n        this.initialized = true;\n        this.initializing = false;\n    }\n\n    /**\n     * Estado padrão da aplicação\n     */\n    getDefaultState() {\n        return {\n            // Projetos\n            tarefas: [],\n            contador: 0,\n\n            // Home\n            tarefasHome: [],\n            contadorHome: 0,\n\n            // Rotina\n            tarefasRotina: [],\n            contadorRotina: 0,\n            historico: [],\n            categorias: [],\n\n            // Estudos\n            areasEstudo: [],\n            topicosEstudo: [],\n            sessoesEstudo: [],\n            contadorEstudos: 0,\n            tagsEstudo: [],\n            configEstudos: {\n                revisaoEspacada: {\n                    ativo: true,\n                    intervalos: [7, 15, 30],\n                },\n                notificacoes: true,\n                viewPadrao: 'kanban',\n            },\n\n            // Gamificação\n            streak: 0,\n            conquistas: {},\n            avaliacoesDiarias: [],\n\n            // UI\n            darkMode: false,\n            filtroStatus: null,\n            diaAtual: new Date().toISOString().split('T')[0],\n\n            // Meta\n            ultimaAtualizacao: new Date().toISOString(),\n        };\n    }\n\n    /**\n     * Carrega estado do cache local\n     */\n    async loadFromCache() {\n        try {\n            const cached = await firebaseCache.get('store-state');\n            if (cached && typeof cached === 'object') {\n                return {\n                    ...this.getDefaultState(),\n                    ...cached\n                };\n            }\n        } catch (error) {\n            console.warn('Erro ao carregar estado do cache:', error);\n        }\n        return null;\n    }\n\n    /**\n     * Carrega estado do Firestore\n     * Sobrescreve dados locais se mais recentes (last-write-wins)\n     */\n    async loadFromFirestore() {\n        if (!firebaseService.isAvailable()) return;\n\n        try {\n            // Mapeamento de coleções do Firestore para chaves do estado\n            const collections = [\n                { collection: 'tarefas', stateKey: 'tarefas' },\n                { collection: 'tarefasRotina', stateKey: 'tarefasRotina' },\n                { collection: 'historico', stateKey: 'historico' },\n                { collection: 'categorias', stateKey: 'categorias' },\n                { collection: 'areasEstudo', stateKey: 'areasEstudo' },\n                { collection: 'topicosEstudo', stateKey: 'topicosEstudo' },\n                { collection: 'sessoesEstudo', stateKey: 'sessoesEstudo' },\n                { collection: 'tagsEstudo', stateKey: 'tagsEstudo' },\n                { collection: 'avaliacoesDiarias', stateKey: 'avaliacoesDiarias' }\n            ];\n\n            const updates = {};\n\n            // Carregar cada coleção do Firestore\n            for (const { collection, stateKey } of collections) {\n                try {\n                    const docs = await firebaseService.getCollection(\n                        collection,\n                        [],\n                        '_lastModified',\n                        'desc'\n                    );\n                    \n                    if (docs && docs.length > 0) {\n                        updates[stateKey] = docs;\n                    }\n                } catch (error) {\n                    console.warn(`Erro ao carregar coleção ${collection}:`, error);\n                }\n            }\n\n            // Carregar configurações\n            try {\n                const config = await firebaseService.getDocument('configEstudos', 'default');\n                if (config) {\n                    updates.configEstudos = config;\n                }\n            } catch (error) {\n                console.warn('Erro ao carregar configEstudos:', error);\n            }\n\n            // Atualizar estado apenas se houver dados do Firestore\n            if (Object.keys(updates).length > 0) {\n                this.state = {\n                    ...this.state,\n                    ...updates\n                };\n                \n                // Salvar no cache local também\n                await firebaseCache.set('store-state', this.state);\n                \n                console.log('✅ Dados carregados do Firestore');\n                this.notify();\n            }\n        } catch (error) {\n            console.error('Erro ao carregar do Firestore:', error);\n        }\n    }\n\n    /**\n     * Salva estado localmente e sincroniza com Firestore (se disponível)\n     */\n    saveToFirestore() {\n        if (this.saveDebounce) {\n            clearTimeout(this.saveDebounce);\n        }\n\n        this.saveDebounce = setTimeout(async () => {\n            try {\n                const stateToSave = {\n                    ...this.state,\n                    ultimaAtualizacao: new Date().toISOString(),\n                };\n\n                // Sempre salvar no cache local primeiro (offline-first)\n                await firebaseCache.set('store-state', stateToSave);\n\n                // Se Firebase está disponível, sincronizar também\n                if (firebaseService.isAvailable()) {\n                    await this._saveCollectionsToFirestore(stateToSave);\n                }\n            } catch (error) {\n                console.error('Erro ao salvar estado:', error);\n            }\n        }, this.DEBOUNCE_DELAY);\n    }\n\n    /**\n     * Salva coleções no Firestore\n     * Usa firebaseSync para garantir sincronização offline/online\n     */\n    async _saveCollectionsToFirestore(state) {\n        if (!firebaseService.isAvailable()) return;\n\n        try {\n            // Mapeamento de chaves do estado para coleções do Firestore\n            const collections = [\n                { stateKey: 'tarefas', collection: 'tarefas' },\n                { stateKey: 'tarefasRotina', collection: 'tarefasRotina' },\n                { stateKey: 'historico', collection: 'historico' },\n                { stateKey: 'categorias', collection: 'categorias' },\n                { stateKey: 'areasEstudo', collection: 'areasEstudo' },\n                { stateKey: 'topicosEstudo', collection: 'topicosEstudo' },\n                { stateKey: 'sessoesEstudo', collection: 'sessoesEstudo' },\n                { stateKey: 'tagsEstudo', collection: 'tagsEstudo' },\n                { stateKey: 'avaliacoesDiarias', collection: 'avaliacoesDiarias' }\n            ];\n\n            const operations = [];\n\n            // Preparar operações para cada coleção\n            for (const { stateKey, collection } of collections) {\n                const items = state[stateKey];\n                if (!Array.isArray(items)) continue;\n\n                // Para cada item, criar operação de sincronização\n                items.forEach(item => {\n                    if (item && item.id) {\n                        operations.push({\n                            type: 'UPDATE', // UPDATE faz merge, CREATE não\n                            collection: collection,\n                            docId: item.id,\n                            data: item\n                        });\n                    }\n                });\n            }\n\n            // Salvar configurações\n            if (state.configEstudos) {\n                operations.push({\n                    type: 'UPDATE',\n                    collection: 'configEstudos',\n                    docId: 'default',\n                    data: state.configEstudos\n                });\n            }\n\n            // Se há operações, adicionar à fila de sincronização\n            if (operations.length > 0) {\n                // Usar batch write se online, senão adicionar à fila\n                if (firebaseSync.getOnlineStatus()) {\n                    try {\n                        // Tentar sincronizar imediatamente se online\n                        await firebaseService.batchWrite(operations);\n                    } catch (error) {\n                        console.warn('Erro ao sincronizar imediatamente, adicionando à fila:', error);\n                        // Se falhar, adicionar à fila para retry\n                        for (const op of operations) {\n                            await firebaseSync.addToQueue(op);\n                        }\n                    }\n                } else {\n                    // Offline: adicionar todas à fila\n                    for (const op of operations) {\n                        await firebaseSync.addToQueue(op);\n                    }\n                }\n            }\n        } catch (error) {\n            console.error('Erro ao salvar coleções no Firestore:', error);\n        }\n    }\n\n    /**\n     * Configura listeners real-time do Firestore\n     * Atualiza estado local quando há mudanças remotas\n     */\n    setupRealtimeListeners() {\n        if (!firebaseService.isAvailable()) return;\n\n        try {\n            // Limpar listeners antigos\n            this.destroy();\n\n            // Coleções principais para listeners real-time\n            const collections = [\n                { collection: 'tarefas', stateKey: 'tarefas' },\n                { collection: 'tarefasRotina', stateKey: 'tarefasRotina' },\n                { collection: 'historico', stateKey: 'historico' },\n                { collection: 'categorias', stateKey: 'categorias' },\n                { collection: 'areasEstudo', stateKey: 'areasEstudo' },\n                { collection: 'topicosEstudo', stateKey: 'topicosEstudo' },\n                { collection: 'sessoesEstudo', stateKey: 'sessoesEstudo' },\n                { collection: 'tagsEstudo', stateKey: 'tagsEstudo' },\n                { collection: 'avaliacoesDiarias', stateKey: 'avaliacoesDiarias' }\n            ];\n\n            // Configurar listener para cada coleção\n            collections.forEach(({ collection, stateKey }) => {\n                const unsubscribe = firebaseService.subscribeToCollection(\n                    collection,\n                    (docs) => {\n                        // Atualizar estado quando coleção muda no Firestore\n                        if (Array.isArray(docs)) {\n                            this.state[stateKey] = docs;\n                            // Salvar no cache local também\n                            firebaseCache.set('store-state', this.state).catch(err => {\n                                console.error('Erro ao salvar no cache após atualização remota:', err);\n                            });\n                            this.notify();\n                        }\n                    },\n                    [] // Sem filtros por enquanto\n                );\n\n                this.listeners.push(unsubscribe);\n            });\n\n            // Listener para configurações\n            const configUnsubscribe = firebaseService.subscribeToDocument(\n                'configEstudos',\n                'default',\n                (doc) => {\n                    if (doc) {\n                        this.state.configEstudos = doc;\n                        firebaseCache.set('store-state', this.state).catch(err => {\n                            console.error('Erro ao salvar config no cache:', err);\n                        });\n                        this.notify();\n                    }\n                }\n            );\n\n            this.listeners.push(configUnsubscribe);\n\n            console.log('✅ Listeners real-time configurados');\n        } catch (error) {\n            console.error('Erro ao configurar listeners real-time:', error);\n        }\n    }\n\n    /**\n     * Método removido - não migra mais para Firestore\n     * Mantido apenas para compatibilidade (não faz nada)\n     */\n    async runMigration() {\n        // Não faz nada - sistema agora é 100% local\n        return;\n    }\n\n    /**\n     * Migração de dados v2 → v3 (do localStorage)\n     * Mantido para compatibilidade, mas será executado apenas uma vez\n     */\n    async migrateFromV2() {\n        try {\n            // Verificar se já migrou para Firestore\n            const migrated = await firebaseCache.get('firestore-migrated');\n            if (migrated) {\n                return;\n            }\n\n            // Chaves do v2 no localStorage\n            const KEY_PROJETOS = 'tarefas_projetos_v2';\n            const KEY_ROTINA = 'tarefas_rotina_v5';\n            const KEY_HISTORICO = 'historico_rotina_v5';\n            const KEY_CATEGORIAS = 'categorias_rotina_v4';\n            const KEY_ESTUDOS = 'estudos_dados_v2';\n            const KEY_AVALIACOES = 'avaliacoes_diarias_v1';\n            const KEY_V3_STATE = 'gerenciador_v3_state';\n\n            let hasData = false;\n\n            // Migrar projetos\n            const projetos = localStorage.getItem(KEY_PROJETOS);\n            if (projetos) {\n                try {\n                    this.state.tarefas = JSON.parse(projetos);\n                    hasData = true;\n                } catch (e) {\n                    console.warn('Erro ao migrar projetos:', e);\n                }\n            }\n\n            // Migrar rotina\n            const rotina = localStorage.getItem(KEY_ROTINA);\n            if (rotina) {\n                try {\n                    this.state.tarefasRotina = JSON.parse(rotina);\n                    hasData = true;\n                } catch (e) {\n                    console.warn('Erro ao migrar rotina:', e);\n                }\n            }\n\n            // Migrar histórico\n            const historico = localStorage.getItem(KEY_HISTORICO);\n            if (historico) {\n                try {\n                    this.state.historico = JSON.parse(historico);\n                    hasData = true;\n                } catch (e) {\n                    console.warn('Erro ao migrar histórico:', e);\n                }\n            }\n\n            // Migrar categorias\n            const categorias = localStorage.getItem(KEY_CATEGORIAS);\n            if (categorias) {\n                try {\n                    this.state.categorias = JSON.parse(categorias);\n                    hasData = true;\n                } catch (e) {\n                    console.warn('Erro ao migrar categorias:', e);\n                }\n            }\n\n            // Migrar estudos\n            const estudos = localStorage.getItem(KEY_ESTUDOS);\n            if (estudos) {\n                try {\n                    const estudosData = JSON.parse(estudos);\n                    this.state.areasEstudo = estudosData.areas || [];\n                    this.state.topicosEstudo = estudosData.topicos || [];\n                    this.state.sessoesEstudo = estudosData.sessoes || [];\n                    this.state.tagsEstudo = estudosData.tags || [];\n                    if (estudosData.config) {\n                        this.state.configEstudos = {\n                            ...this.state.configEstudos,\n                            ...estudosData.config\n                        };\n                    }\n                    hasData = true;\n                } catch (e) {\n                    console.warn('Erro ao migrar estudos:', e);\n                }\n            }\n\n            // Migrar avaliações\n            const avaliacoes = localStorage.getItem(KEY_AVALIACOES);\n            if (avaliacoes) {\n                try {\n                    this.state.avaliacoesDiarias = JSON.parse(avaliacoes);\n                    hasData = true;\n                } catch (e) {\n                    console.warn('Erro ao migrar avaliações:', e);\n                }\n            }\n\n            // Tentar migrar estado v3 completo\n            const v3State = localStorage.getItem(KEY_V3_STATE);\n            if (v3State) {\n                try {\n                    const parsed = JSON.parse(v3State);\n                    this.state = {\n                        ...this.state,\n                        ...parsed\n                    };\n                    hasData = true;\n                } catch (e) {\n                    console.warn('Erro ao migrar estado v3:', e);\n                }\n            }\n\n            // Se houver dados migrados, salvar localmente\n            if (hasData) {\n                await this.saveToFirestore();\n                // Forçar salvamento imediato\n                if (this.saveDebounce) {\n                    clearTimeout(this.saveDebounce);\n                }\n                const stateToSave = {\n                    ...this.state,\n                    ultimaAtualizacao: new Date().toISOString(),\n                };\n                await firebaseCache.set('store-state', stateToSave);\n            }\n\n            // Marcar como migrado\n            await firebaseCache.set('firestore-migrated', true);\n\n            if (hasData) {\n                console.log('✅ Migração v2/v3 concluída');\n                this.notify();\n            }\n        } catch (error) {\n            console.error('Erro na migração:', error);\n        }\n    }\n\n    /**\n     * Inscreve callback para mudanças de estado\n     */\n    subscribe(callback) {\n        this.subscribers.push(callback);\n        // Retorna função para desinscrever\n        return () => {\n            this.subscribers = this.subscribers.filter((cb) => cb !== callback);\n        };\n    }\n\n    /**\n     * Notifica todos os subscribers\n     */\n    notify() {\n        this.subscribers.forEach((callback) => {\n            try {\n                callback(this.state);\n            } catch (error) {\n                console.error('Erro ao notificar subscriber:', error);\n            }\n        });\n    }\n\n    /**\n     * Atualiza estado e notifica subscribers\n     */\n    setState(updates) {\n        this.state = {\n            ...this.state,\n            ...updates\n        };\n        this.saveToFirestore();\n        this.notify();\n    }\n\n    /**\n     * Retorna estado atual\n     */\n    getState() {\n        return {\n            ...this.state\n        };\n    }\n\n    /**\n     * Retorna parte específica do estado\n     */\n    getStateSlice(key) {\n        return this.state[key];\n    }\n\n    /**\n     * Atualiza parte específica do estado (merge)\n     */\n    updateStateSlice(key, updates) {\n        const current = this.state[key];\n        if (Array.isArray(current)) {\n            this.setState({\n                [key]: [...current, ...updates]\n            });\n        } else if (typeof current === 'object' && current !== null) {\n            this.setState({\n                [key]: {\n                    ...current,\n                    ...updates\n                }\n            });\n        } else {\n            this.setState({\n                [key]: updates\n            });\n        }\n    }\n\n    /**\n     * Adiciona item a uma lista no estado\n     */\n    addItem(key, item) {\n        const current = this.state[key];\n        if (Array.isArray(current)) {\n            this.setState({\n                [key]: [...current, item]\n            });\n        }\n    }\n\n    /**\n     * Remove item de uma lista no estado\n     */\n    removeItem(key, predicate) {\n        const current = this.state[key];\n        if (Array.isArray(current)) {\n            this.setState({\n                [key]: current.filter((item) => !predicate(item))\n            });\n        }\n    }\n\n    /**\n     * Atualiza item em uma lista no estado\n     */\n    updateItem(key, predicate, updates) {\n        const current = this.state[key];\n        if (Array.isArray(current)) {\n            this.setState({\n                [key]: current.map((item) => (predicate(item) ? {\n                    ...item,\n                    ...updates\n                } : item)),\n            });\n        }\n    }\n\n    /**\n     * Força salvamento imediato (sem debounce)\n     */\n    async forceSave() {\n        if (this.saveDebounce) {\n            clearTimeout(this.saveDebounce);\n        }\n        try {\n            const stateToSave = {\n                ...this.state,\n                ultimaAtualizacao: new Date().toISOString(),\n            };\n            await firebaseCache.set('store-state', stateToSave);\n        } catch (error) {\n            console.error('Erro ao forçar salvamento:', error);\n        }\n    }\n\n    /**\n     * Limpa todos os listeners\n     */\n    destroy() {\n        this.listeners.forEach(unsubscribe => unsubscribe());\n        this.listeners = [];\n    }\n}\n\n// Exportar instância singleton\nexport const store = new Store();\nexport default store;"],"names":["Store","firebaseCache","cachedState","firebaseService","error","cached","collections","updates","collection","stateKey","docs","config","stateToSave","state","operations","items","item","firebaseSync","op","unsubscribe","err","configUnsubscribe","doc","KEY_PROJETOS","KEY_ROTINA","KEY_HISTORICO","KEY_CATEGORIAS","KEY_ESTUDOS","KEY_AVALIACOES","KEY_V3_STATE","hasData","projetos","e","rotina","historico","categorias","estudos","estudosData","avaliacoes","v3State","parsed","callback","cb","key","current","predicate","store"],"mappings":"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"}